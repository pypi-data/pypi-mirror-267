function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
var zn=Object.defineProperty;var Vn=(e,t,l)=>t in e?zn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var U=(e,t,l)=>(Vn(e,typeof t!="symbol"?t+"":t,l),l),Rt=(e,t,l)=>{if(!t.has(e))throw TypeError("Cannot "+l)};var c=(e,t,l)=>(Rt(e,t,"read from private field"),l?l.call(e):t.get(e)),I=(e,t,l)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,l)},x=(e,t,l,n)=>(Rt(e,t,"write to private field"),n?n.call(e,l):t.set(e,l),l);var vt=(e,t,l,n)=>({set _(o){x(e,t,o,l)},get _(){return c(e,t,n)}}),E=(e,t,l)=>(Rt(e,t,"access private method"),l);import{R as At,I as jt,$ as Wn,L as Un,H as Gn,x as qn}from"./@vavt-B4fzJ49s.js";import{d as K,i as O,c as u,r as ae,a as G,w as H,o as q,b as gt,e as zt,s as Ge,f as he,n as Fe,T as Kn,h as Zn,F as It,p as Ae,t as je,g as Xn}from"./@vue-4wI8zz7n.js";import{_ as Yn,E as Ne,H as wn,s as $n,k as Jn,d as Qn,h as eo,i as to,a as Ul,m as lo,u as no,r as oo,b as io,c as Ie,e as Ot,f as ao,p as so,C as Je,l as ro,S as co,g as uo}from"./@codemirror-A36Vwj5Y.js";import{a as k}from"./@lezer-C8l2HfTs.js";import{m as ho}from"./medium-zoom-CHfgT04g.js";import{c as mo}from"./copy-to-clipboard-B1uT6SkR.js";import{M as fo}from"./markdown-it-DI8MEbma.js";import{r as go}from"./markdown-it-image-figures-BD49Kf-b.js";import{T as vo}from"./markdown-it-task-lists-BNI9E7ji.js";import{X as po}from"./markdown-it-xss-DEpVfk-m.js";import{p as Pt}from"./vite-plugin-node-polyfills-C8Q2m4YJ.js";const h="md-editor",bo="https://at.alicdn.com/t/c/font_2605852_prouiefeic.js",yo="https://at.alicdn.com/t/c/font_2605852_prouiefeic.css",W="https://cdnjs.cloudflare.com/ajax/libs",ko=`${W}/highlight.js/11.8.0/highlight.min.js`,Gl={main:`${W}/prettier/2.8.0/standalone.js`,markdown:`${W}/prettier/2.8.0/parser-markdown.js`},ql={css:`${W}/cropperjs/1.5.13/cropper.min.css`,js:`${W}/cropperjs/1.5.13/cropper.min.js`},Co=`${W}/screenfull.js/5.2.0/screenfull.min.js`,Tn=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","htmlPreview","catalog","github"],_n=["markdownTotal","=","scrollSwitch"],Kl={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},wo=`${W}/mermaid/10.6.1/mermaid.esm.min.mjs`,Zl={js:`${W}/KaTeX/0.16.9/katex.min.js`,css:`${W}/KaTeX/0.16.9/katex.min.css`},Xl={a11y:{light:`${W}/highlight.js/11.8.0/styles/a11y-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/a11y-dark.min.css`},atom:{light:`${W}/highlight.js/11.8.0/styles/atom-one-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/atom-one-dark.min.css`},github:{light:`${W}/highlight.js/11.8.0/styles/github.min.css`,dark:`${W}/highlight.js/11.8.0/styles/github-dark.min.css`},gradient:{light:`${W}/highlight.js/11.8.0/styles/gradient-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/gradient-dark.min.css`},kimbie:{light:`${W}/highlight.js/11.8.0/styles/kimbie-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/kimbie-dark.min.css`},paraiso:{light:`${W}/highlight.js/11.8.0/styles/paraiso-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${W}/highlight.js/11.8.0/styles/qtcreator-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${W}/highlight.js/11.8.0/styles/stackoverflow-light.min.css`,dark:`${W}/highlight.js/11.8.0/styles/stackoverflow-dark.min.css`}},Z={editorExtensions:{},editorConfig:{},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e},pt=170,ge=({instance:e,ctx:t,props:l={}},n="default")=>{const o=(e==null?void 0:e.$slots[n])||(t==null?void 0:t.slots[n]);return(o?o(e):"")||l[n]},$o={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},Qe=K({props:$o,setup(e,t){const l=`${h}-dropdown-hidden`,n=ae({overlayClass:[l],overlayStyle:{},triggerHover:!1,overlayHover:!1}),o=G(),i=G(),a=()=>{var r;n.triggerHover=!0;const f=o.value,w=i.value;if(!f||!w)return;const C=f.getBoundingClientRect(),p=f.offsetTop,y=f.offsetLeft,v=C.height,g=C.width,b=((r=document.querySelector(e.relative))==null?void 0:r.scrollLeft)||0;n.overlayStyle={...n.overlayStyle,top:p+v+"px",left:y-w.offsetWidth/2+g/2-b+"px"},e.onChange(!0)},m=()=>{n.overlayHover=!0};H(()=>e.visible,r=>{r?n.overlayClass=n.overlayClass.filter(f=>f!==l):n.overlayClass.push(l)});let d=-1;const s=r=>{o.value===r.target?n.triggerHover=!1:n.overlayHover=!1,clearTimeout(d),d=window.setTimeout(()=>{!n.overlayHover&&!n.triggerHover&&e.onChange(!1)},10)};return q(()=>{o.value.addEventListener("mouseenter",a),o.value.addEventListener("mouseleave",s),i.value.addEventListener("mouseenter",m),i.value.addEventListener("mouseleave",s)}),gt(()=>{o.value.removeEventListener("mouseenter",a),o.value.removeEventListener("mouseleave",s),i.value.removeEventListener("mouseenter",m),i.value.removeEventListener("mouseleave",s)}),()=>{const r=ge({ctx:t}),f=ge({props:e,ctx:t},"overlay"),w=zt(r instanceof Array?r[0]:r,{ref:o}),C=u("div",{class:[`${h}-dropdown`,n.overlayClass],style:n.overlayStyle,ref:i},[u("div",{class:`${h}-dropdown-overlay`},[f instanceof Array?f[0]:f])]);return[w,C]}}}),To={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},default:{type:[String,Object]}},yt=K({name:"DropdownToolbar",props:To,emits:["onChange"],setup(e,t){const l=O("editorId");return()=>{const n=ge({props:e,ctx:t},"trigger"),o=ge({props:e,ctx:t},"overlay"),i=ge({props:e,ctx:t});return u(Qe,{relative:`#${l}-toolbar-wrapper`,visible:e.visible,onChange:a=>{e.onChange instanceof Function?e.onChange(a):t.emit("onChange",a)},overlay:o},{default:()=>[u("div",{class:`${h}-toolbar-item`,title:e.title||""},[n,i])]})}}});yt.install=e=>(e.component(yt.name,yt),e);var _o=Object.defineProperty,So=(e,t,l)=>t in e?_o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,Eo=(e,t,l)=>(So(e,typeof t!="symbol"?t+"":t,l),l);class xo{constructor(){Eo(this,"pools",{})}remove(t,l,n){const i=this.pools[t]&&this.pools[t][l];i&&(this.pools[t][l]=i.filter(a=>a!==n))}clear(t){this.pools[t]={}}on(t,l){return this.pools[t]||(this.pools[t]={}),this.pools[t][l.name]||(this.pools[t][l.name]=[]),this.pools[t][l.name].push(l.callback),this.pools[t][l.name].includes(l.callback)}emit(t,l,...n){this.pools[t]||(this.pools[t]={});const i=this.pools[t][l];i&&i.forEach(a=>{try{a(...n)}catch(m){console.error(`${l} monitor event exception！`,m)}})}}const $=new xo,Lt="onSave",Yt="changeCatalogVisible",Sn="changeFullscreen",Yl="pageFullscreenChanged",Jl="fullscreenChanged",Ql="previewChanged",en="htmlPreviewChanged",tn="catalogVisibleChanged",kt="buildFinished",qe="errorCatcher",V="replace",Ft="uploadImage",Vt="openModals",En="ctrlZ",xn="ctrlShiftZ",Wt="catalogChanged",An="pushCatalog",Jt="rerender",In="eventListener",Ao=(e,t="image.png")=>{const l=e.split(","),n=l[0].match(/:(.*?);/);if(n){const o=n[1],i=atob(l[1]);let a=i.length;const m=new Uint8Array(a);for(;a--;)m[a]=i.charCodeAt(a);return new File([m],t,{type:o})}return null},Io=e=>{if(!e)return e;const t=e.split(`
`),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{l.push("<span></span>")}),l.push("</span>"),`<span class="code-block">${e}</span>${l.join("")}`},Lo=(e,t)=>{if(!e||!t)return 0;const l=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const n=t==null?void 0:t.getBoundingClientRect();return l.top-n.top},Fo=(()=>{let e=0;return t=>t+ ++e})(),ln=(e,t)=>{const l=n=>{const o=e.parentElement||document.body,i=o.offsetWidth,a=o.offsetHeight,{clientWidth:m}=document.documentElement,{clientHeight:d}=document.documentElement,s=n.offsetX,r=n.offsetY,f=C=>{let p=C.x+document.body.scrollLeft-document.body.clientLeft-s,y=C.y+document.body.scrollTop-document.body.clientTop-r;p=p<1?1:p<m-i-1?p:m-i-1,y=y<1?1:y<d-a-1?y:d-a-1,t?t(p,y):(o.style.left=`${p}px`,o.style.top=`${y}px`)};document.addEventListener("mousemove",f);const w=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",w)};document.addEventListener("mouseup",w)};return e.addEventListener("mousedown",l),()=>{e.removeEventListener("mousedown",l)}},fe=(e,t="")=>{const l=document.getElementById(e.id),n=e.onload;e.onload=null;const o=function(i){typeof n=="function"&&n.bind(this)(i),e.removeEventListener("load",o)};l?t!==""&&(l.addEventListener("load",o),Reflect.get(window,t)&&l.dispatchEvent(new Event("load"))):(e.addEventListener("load",o),document.head.appendChild(e))},Ho=At((e,t,l)=>{const n=document.getElementById(e);n&&n.setAttribute(t,l)},10),Mo=K({props:{name:{type:String,default:""}},setup(e){return()=>Z.iconfontType==="svg"?u("svg",{class:`${h}-icon`,"aria-hidden":"true"},[u("use",{"xlink:href":`#${h}-icon-${e.name}`},null)]):u("i",{class:`${h}-iconfont ${h}-icon-${e.name}`},null)}}),M=K({props:{name:{type:String,default:""}},setup(e){const t=O("customIcon");return()=>{const l=t.value[e.name];return typeof l=="object"?typeof l.component=="object"?Zn(l.component,l.props):u("span",{innerHTML:l.component},null):u(Mo,{name:e.name},null)}}}),Ro={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}},class:{type:String},style:{type:Object,default:()=>({})}},nn=(()=>{let e=2e4;return()=>++e})(),et=K({name:"MdModal",props:Ro,emits:["onClose"],setup(e,t){const l=O("theme"),n=G(e.visible),o=G([`${h}-modal`]),i=G(),a=G(),m=G(),d=Ge();let s=()=>{};const r=ae({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),f=he(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});return H(()=>e.isFullscreen,w=>{w?s():Fe(()=>{s=ln(a.value,(C,p)=>{r.initPos.left=C+"px",r.initPos.top=p+"px"})})}),H(()=>e.visible,w=>{w?(r.maskStyle.zIndex=nn(),r.modalStyle.zIndex=nn(),o.value.push("zoom-in"),n.value=w,Fe(()=>{const C=i.value.offsetWidth/2,p=i.value.offsetHeight/2,y=document.documentElement.clientWidth/2,v=document.documentElement.clientHeight/2;r.initPos.left=y-C+"px",r.initPos.top=v-p+"px",e.isFullscreen||(s=ln(a.value,(g,b)=>{r.initPos.left=g+"px",r.initPos.top=b+"px"}))}),setTimeout(()=>{o.value=o.value.filter(C=>C!=="zoom-in")},140)):(o.value.push("zoom-out"),s(),setTimeout(()=>{o.value=o.value.filter(C=>C!=="zoom-out"),n.value=w},130))}),q(()=>{m.value=document.body}),()=>{const w=ge({ctx:t}),C=ge({props:e,ctx:t},"title");return m.value?u(Kn,{to:m.value},{default:()=>[u("div",{ref:d,class:`${h}-modal-container`,"data-theme":l.value},[u("div",{class:e.class,style:{...e.style,display:n.value?"block":"none"}},[u("div",{class:`${h}-modal-mask`,style:r.maskStyle,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),u("div",{class:o.value,style:{...r.modalStyle,...r.initPos,...f.value},ref:i},[u("div",{class:`${h}-modal-header`,ref:a},[C||""]),u("div",{class:`${h}-modal-body`},[w]),u("div",{class:`${h}-modal-func`},[e.showAdjust&&u("div",{class:`${h}-modal-adjust`,onClick:p=>{p.stopPropagation(),e.isFullscreen?r.initPos=r.historyPos:(r.historyPos=r.initPos,r.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[u(M,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),u("div",{class:`${h}-modal-close`,onClick:p=>{p.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[u(M,{name:"close"},null)])])])])])]}):""}}});et.install=e=>(e.component(et.name,et),e);const Xe=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Ln=new Set,Ut=typeof Pt=="object"&&Pt?Pt:{},Fn=(e,t,l,n)=>{typeof Ut.emitWarning=="function"?Ut.emitWarning(e,t,l,n):console.error(`[${l}] ${t}: ${e}`)};let Et=globalThis.AbortController,on=globalThis.AbortSignal;var Cn;if(typeof Et>"u"){on=class{constructor(){U(this,"onabort");U(this,"_onabort",[]);U(this,"reason");U(this,"aborted",!1)}addEventListener(n,o){this._onabort.push(o)}},Et=class{constructor(){U(this,"signal",new on);t()}abort(n){var o,i;if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(const a of this.signal._onabort)a(n);(i=(o=this.signal).onabort)==null||i.call(o,n)}}};let e=((Cn=Ut.env)==null?void 0:Cn.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const t=()=>{e&&(e=!1,Fn("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const Oo=e=>!Ln.has(e),Oe=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Hn=e=>Oe(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Ct:null:null;class Ct extends Array{constructor(t){super(t),this.fill(0)}}var tt;const ze=class ze{constructor(t,l){U(this,"heap");U(this,"length");if(!c(ze,tt))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new l(t),this.length=0}static create(t){const l=Hn(t);if(!l)return[];x(ze,tt,!0);const n=new ze(t,l);return x(ze,tt,!1),n}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}};tt=new WeakMap,I(ze,tt,!1);let Gt=ze;var pe,re,be,ye,lt,Y,ke,X,z,A,ne,ce,le,J,Ce,Q,we,$e,ue,Te,Be,oe,ut,Kt,Ve,Le,dt,de,xt,Mn,We,nt,ht,Se,Pe,Ee,De,mt,Zt,$a,ot,wt,it,$t,D,j,ft,Xt,Ue,at;const Qt=class Qt{constructor(t){I(this,ut);I(this,xt);I(this,Se);I(this,Ee);I(this,mt);I(this,ot);I(this,it);I(this,D);I(this,ft);I(this,Ue);I(this,pe,void 0);I(this,re,void 0);I(this,be,void 0);I(this,ye,void 0);I(this,lt,void 0);U(this,"ttl");U(this,"ttlResolution");U(this,"ttlAutopurge");U(this,"updateAgeOnGet");U(this,"updateAgeOnHas");U(this,"allowStale");U(this,"noDisposeOnSet");U(this,"noUpdateTTL");U(this,"maxEntrySize");U(this,"sizeCalculation");U(this,"noDeleteOnFetchRejection");U(this,"noDeleteOnStaleGet");U(this,"allowStaleOnFetchAbort");U(this,"allowStaleOnFetchRejection");U(this,"ignoreFetchAbort");I(this,Y,void 0);I(this,ke,void 0);I(this,X,void 0);I(this,z,void 0);I(this,A,void 0);I(this,ne,void 0);I(this,ce,void 0);I(this,le,void 0);I(this,J,void 0);I(this,Ce,void 0);I(this,Q,void 0);I(this,we,void 0);I(this,$e,void 0);I(this,ue,void 0);I(this,Te,void 0);I(this,Be,void 0);I(this,oe,void 0);I(this,Ve,()=>{});I(this,Le,()=>{});I(this,dt,()=>{});I(this,de,()=>!1);I(this,We,t=>{});I(this,nt,(t,l,n)=>{});I(this,ht,(t,l,n,o)=>{if(n||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});U(this,$a,"LRUCache");const{max:l=0,ttl:n,ttlResolution:o=1,ttlAutopurge:i,updateAgeOnGet:a,updateAgeOnHas:m,allowStale:d,dispose:s,disposeAfter:r,noDisposeOnSet:f,noUpdateTTL:w,maxSize:C=0,maxEntrySize:p=0,sizeCalculation:y,fetchMethod:v,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:b,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:_,ignoreFetchAbort:S}=t;if(l!==0&&!Oe(l))throw new TypeError("max option must be a nonnegative integer");const L=l?Hn(l):Array;if(!L)throw new Error("invalid max value: "+l);if(x(this,pe,l),x(this,re,C),this.maxEntrySize=p||c(this,re),this.sizeCalculation=y,this.sizeCalculation){if(!c(this,re)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("fetchMethod must be a function if specified");if(x(this,lt,v),x(this,Be,!!v),x(this,X,new Map),x(this,z,new Array(l).fill(void 0)),x(this,A,new Array(l).fill(void 0)),x(this,ne,new L(l)),x(this,ce,new L(l)),x(this,le,0),x(this,J,0),x(this,Ce,Gt.create(l)),x(this,Y,0),x(this,ke,0),typeof s=="function"&&x(this,be,s),typeof r=="function"?(x(this,ye,r),x(this,Q,[])):(x(this,ye,void 0),x(this,Q,void 0)),x(this,Te,!!c(this,be)),x(this,oe,!!c(this,ye)),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!w,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!_,this.ignoreFetchAbort=!!S,this.maxEntrySize!==0){if(c(this,re)!==0&&!Oe(c(this,re)))throw new TypeError("maxSize must be a positive integer if specified");if(!Oe(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");E(this,xt,Mn).call(this)}if(this.allowStale=!!d,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!m,this.ttlResolution=Oe(o)||o===0?o:1,this.ttlAutopurge=!!i,this.ttl=n||0,this.ttl){if(!Oe(this.ttl))throw new TypeError("ttl must be a positive integer if specified");E(this,ut,Kt).call(this)}if(c(this,pe)===0&&this.ttl===0&&c(this,re)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!c(this,pe)&&!c(this,re)){const F="LRU_CACHE_UNBOUNDED";Oo(F)&&(Ln.add(F),Fn("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",F,Qt))}}static unsafeExposeInternals(t){return{starts:c(t,$e),ttls:c(t,ue),sizes:c(t,we),keyMap:c(t,X),keyList:c(t,z),valList:c(t,A),next:c(t,ne),prev:c(t,ce),get head(){return c(t,le)},get tail(){return c(t,J)},free:c(t,Ce),isBackgroundFetch:l=>{var n;return E(n=t,D,j).call(n,l)},backgroundFetch:(l,n,o,i)=>{var a;return E(a=t,it,$t).call(a,l,n,o,i)},moveToTail:l=>{var n;return E(n=t,Ue,at).call(n,l)},indexes:l=>{var n;return E(n=t,Se,Pe).call(n,l)},rindexes:l=>{var n;return E(n=t,Ee,De).call(n,l)},isStale:l=>{var n;return c(n=t,de).call(n,l)}}}get max(){return c(this,pe)}get maxSize(){return c(this,re)}get calculatedSize(){return c(this,ke)}get size(){return c(this,Y)}get fetchMethod(){return c(this,lt)}get dispose(){return c(this,be)}get disposeAfter(){return c(this,ye)}getRemainingTTL(t){return c(this,X).has(t)?1/0:0}*entries(){for(const t of E(this,Se,Pe).call(this))c(this,A)[t]!==void 0&&c(this,z)[t]!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield[c(this,z)[t],c(this,A)[t]])}*rentries(){for(const t of E(this,Ee,De).call(this))c(this,A)[t]!==void 0&&c(this,z)[t]!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield[c(this,z)[t],c(this,A)[t]])}*keys(){for(const t of E(this,Se,Pe).call(this)){const l=c(this,z)[t];l!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield l)}}*rkeys(){for(const t of E(this,Ee,De).call(this)){const l=c(this,z)[t];l!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield l)}}*values(){for(const t of E(this,Se,Pe).call(this))c(this,A)[t]!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield c(this,A)[t])}*rvalues(){for(const t of E(this,Ee,De).call(this))c(this,A)[t]!==void 0&&!E(this,D,j).call(this,c(this,A)[t])&&(yield c(this,A)[t])}[Symbol.iterator](){return this.entries()}find(t,l={}){for(const n of E(this,Se,Pe).call(this)){const o=c(this,A)[n],i=E(this,D,j).call(this,o)?o.__staleWhileFetching:o;if(i!==void 0&&t(i,c(this,z)[n],this))return this.get(c(this,z)[n],l)}}forEach(t,l=this){for(const n of E(this,Se,Pe).call(this)){const o=c(this,A)[n],i=E(this,D,j).call(this,o)?o.__staleWhileFetching:o;i!==void 0&&t.call(l,i,c(this,z)[n],this)}}rforEach(t,l=this){for(const n of E(this,Ee,De).call(this)){const o=c(this,A)[n],i=E(this,D,j).call(this,o)?o.__staleWhileFetching:o;i!==void 0&&t.call(l,i,c(this,z)[n],this)}}purgeStale(){let t=!1;for(const l of E(this,Ee,De).call(this,{allowStale:!0}))c(this,de).call(this,l)&&(this.delete(c(this,z)[l]),t=!0);return t}info(t){const l=c(this,X).get(t);if(l===void 0)return;const n=c(this,A)[l],o=E(this,D,j).call(this,n)?n.__staleWhileFetching:n;if(o===void 0)return;const i={value:o};if(c(this,ue)&&c(this,$e)){const a=c(this,ue)[l],m=c(this,$e)[l];if(a&&m){const d=a-(Xe.now()-m);i.ttl=d,i.start=Date.now()}}return c(this,we)&&(i.size=c(this,we)[l]),i}dump(){const t=[];for(const l of E(this,Se,Pe).call(this,{allowStale:!0})){const n=c(this,z)[l],o=c(this,A)[l],i=E(this,D,j).call(this,o)?o.__staleWhileFetching:o;if(i===void 0||n===void 0)continue;const a={value:i};if(c(this,ue)&&c(this,$e)){a.ttl=c(this,ue)[l];const m=Xe.now()-c(this,$e)[l];a.start=Math.floor(Date.now()-m)}c(this,we)&&(a.size=c(this,we)[l]),t.unshift([n,a])}return t}load(t){this.clear();for(const[l,n]of t){if(n.start){const o=Date.now()-n.start;n.start=Xe.now()-o}this.set(l,n.value,n)}}set(t,l,n={}){var w,C,p,y,v;if(l===void 0)return this.delete(t),this;const{ttl:o=this.ttl,start:i,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:m=this.sizeCalculation,status:d}=n;let{noUpdateTTL:s=this.noUpdateTTL}=n;const r=c(this,ht).call(this,t,l,n.size||0,m);if(this.maxEntrySize&&r>this.maxEntrySize)return d&&(d.set="miss",d.maxEntrySizeExceeded=!0),this.delete(t),this;let f=c(this,Y)===0?void 0:c(this,X).get(t);if(f===void 0)f=c(this,Y)===0?c(this,J):c(this,Ce).length!==0?c(this,Ce).pop():c(this,Y)===c(this,pe)?E(this,ot,wt).call(this,!1):c(this,Y),c(this,z)[f]=t,c(this,A)[f]=l,c(this,X).set(t,f),c(this,ne)[c(this,J)]=f,c(this,ce)[f]=c(this,J),x(this,J,f),vt(this,Y)._++,c(this,nt).call(this,f,r,d),d&&(d.set="add"),s=!1;else{E(this,Ue,at).call(this,f);const g=c(this,A)[f];if(l!==g){if(c(this,Be)&&E(this,D,j).call(this,g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:b}=g;b!==void 0&&!a&&(c(this,Te)&&((w=c(this,be))==null||w.call(this,b,t,"set")),c(this,oe)&&((C=c(this,Q))==null||C.push([b,t,"set"])))}else a||(c(this,Te)&&((p=c(this,be))==null||p.call(this,g,t,"set")),c(this,oe)&&((y=c(this,Q))==null||y.push([g,t,"set"])));if(c(this,We).call(this,f),c(this,nt).call(this,f,r,d),c(this,A)[f]=l,d){d.set="replace";const b=g&&E(this,D,j).call(this,g)?g.__staleWhileFetching:g;b!==void 0&&(d.oldValue=b)}}else d&&(d.set="update")}if(o!==0&&!c(this,ue)&&E(this,ut,Kt).call(this),c(this,ue)&&(s||c(this,dt).call(this,f,o,i),d&&c(this,Le).call(this,d,f)),!a&&c(this,oe)&&c(this,Q)){const g=c(this,Q);let b;for(;b=g==null?void 0:g.shift();)(v=c(this,ye))==null||v.call(this,...b)}return this}pop(){var t;try{for(;c(this,Y);){const l=c(this,A)[c(this,le)];if(E(this,ot,wt).call(this,!0),E(this,D,j).call(this,l)){if(l.__staleWhileFetching)return l.__staleWhileFetching}else if(l!==void 0)return l}}finally{if(c(this,oe)&&c(this,Q)){const l=c(this,Q);let n;for(;n=l==null?void 0:l.shift();)(t=c(this,ye))==null||t.call(this,...n)}}}has(t,l={}){const{updateAgeOnHas:n=this.updateAgeOnHas,status:o}=l,i=c(this,X).get(t);if(i!==void 0){const a=c(this,A)[i];if(E(this,D,j).call(this,a)&&a.__staleWhileFetching===void 0)return!1;if(c(this,de).call(this,i))o&&(o.has="stale",c(this,Le).call(this,o,i));else return n&&c(this,Ve).call(this,i),o&&(o.has="hit",c(this,Le).call(this,o,i)),!0}else o&&(o.has="miss");return!1}peek(t,l={}){const{allowStale:n=this.allowStale}=l,o=c(this,X).get(t);if(o===void 0||!n&&c(this,de).call(this,o))return;const i=c(this,A)[o];return E(this,D,j).call(this,i)?i.__staleWhileFetching:i}async fetch(t,l={}){const{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:m=this.noDisposeOnSet,size:d=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:r=this.noUpdateTTL,noDeleteOnFetchRejection:f=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:w=this.allowStaleOnFetchRejection,ignoreFetchAbort:C=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:y,forceRefresh:v=!1,status:g,signal:b}=l;if(!c(this,Be))return g&&(g.fetch="get"),this.get(t,{allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:i,status:g});const T={allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:i,ttl:a,noDisposeOnSet:m,size:d,sizeCalculation:s,noUpdateTTL:r,noDeleteOnFetchRejection:f,allowStaleOnFetchRejection:w,allowStaleOnFetchAbort:p,ignoreFetchAbort:C,status:g,signal:b};let _=c(this,X).get(t);if(_===void 0){g&&(g.fetch="miss");const S=E(this,it,$t).call(this,t,_,T,y);return S.__returned=S}else{const S=c(this,A)[_];if(E(this,D,j).call(this,S)){const P=n&&S.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",P&&(g.returnedStale=!0)),P?S.__staleWhileFetching:S.__returned=S}const L=c(this,de).call(this,_);if(!v&&!L)return g&&(g.fetch="hit"),E(this,Ue,at).call(this,_),o&&c(this,Ve).call(this,_),g&&c(this,Le).call(this,g,_),S;const F=E(this,it,$t).call(this,t,_,T,y),B=F.__staleWhileFetching!==void 0&&n;return g&&(g.fetch=L?"stale":"refresh",B&&L&&(g.returnedStale=!0)),B?F.__staleWhileFetching:F.__returned=F}}get(t,l={}){const{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:a}=l,m=c(this,X).get(t);if(m!==void 0){const d=c(this,A)[m],s=E(this,D,j).call(this,d);return a&&c(this,Le).call(this,a,m),c(this,de).call(this,m)?(a&&(a.get="stale"),s?(a&&n&&d.__staleWhileFetching!==void 0&&(a.returnedStale=!0),n?d.__staleWhileFetching:void 0):(i||this.delete(t),a&&n&&(a.returnedStale=!0),n?d:void 0)):(a&&(a.get="hit"),s?d.__staleWhileFetching:(E(this,Ue,at).call(this,m),o&&c(this,Ve).call(this,m),d))}else a&&(a.get="miss")}delete(t){var n,o,i,a;let l=!1;if(c(this,Y)!==0){const m=c(this,X).get(t);if(m!==void 0)if(l=!0,c(this,Y)===1)this.clear();else{c(this,We).call(this,m);const d=c(this,A)[m];if(E(this,D,j).call(this,d)?d.__abortController.abort(new Error("deleted")):(c(this,Te)||c(this,oe))&&(c(this,Te)&&((n=c(this,be))==null||n.call(this,d,t,"delete")),c(this,oe)&&((o=c(this,Q))==null||o.push([d,t,"delete"]))),c(this,X).delete(t),c(this,z)[m]=void 0,c(this,A)[m]=void 0,m===c(this,J))x(this,J,c(this,ce)[m]);else if(m===c(this,le))x(this,le,c(this,ne)[m]);else{const s=c(this,ce)[m];c(this,ne)[s]=c(this,ne)[m];const r=c(this,ne)[m];c(this,ce)[r]=c(this,ce)[m]}vt(this,Y)._--,c(this,Ce).push(m)}}if(c(this,oe)&&((i=c(this,Q))!=null&&i.length)){const m=c(this,Q);let d;for(;d=m==null?void 0:m.shift();)(a=c(this,ye))==null||a.call(this,...d)}return l}clear(){var t,l,n;for(const o of E(this,Ee,De).call(this,{allowStale:!0})){const i=c(this,A)[o];if(E(this,D,j).call(this,i))i.__abortController.abort(new Error("deleted"));else{const a=c(this,z)[o];c(this,Te)&&((t=c(this,be))==null||t.call(this,i,a,"delete")),c(this,oe)&&((l=c(this,Q))==null||l.push([i,a,"delete"]))}}if(c(this,X).clear(),c(this,A).fill(void 0),c(this,z).fill(void 0),c(this,ue)&&c(this,$e)&&(c(this,ue).fill(0),c(this,$e).fill(0)),c(this,we)&&c(this,we).fill(0),x(this,le,0),x(this,J,0),c(this,Ce).length=0,x(this,ke,0),x(this,Y,0),c(this,oe)&&c(this,Q)){const o=c(this,Q);let i;for(;i=o==null?void 0:o.shift();)(n=c(this,ye))==null||n.call(this,...i)}}};$a=Symbol.toStringTag,pe=new WeakMap,re=new WeakMap,be=new WeakMap,ye=new WeakMap,lt=new WeakMap,Y=new WeakMap,ke=new WeakMap,X=new WeakMap,z=new WeakMap,A=new WeakMap,ne=new WeakMap,ce=new WeakMap,le=new WeakMap,J=new WeakMap,Ce=new WeakMap,Q=new WeakMap,we=new WeakMap,$e=new WeakMap,ue=new WeakMap,Te=new WeakMap,Be=new WeakMap,oe=new WeakMap,ut=new WeakSet,Kt=function(){const t=new Ct(c(this,pe)),l=new Ct(c(this,pe));x(this,ue,t),x(this,$e,l),x(this,dt,(i,a,m=Xe.now())=>{if(l[i]=a!==0?m:0,t[i]=a,a!==0&&this.ttlAutopurge){const d=setTimeout(()=>{c(this,de).call(this,i)&&this.delete(c(this,z)[i])},a+1);d.unref&&d.unref()}}),x(this,Ve,i=>{l[i]=t[i]!==0?Xe.now():0}),x(this,Le,(i,a)=>{if(t[a]){const m=t[a],d=l[a];if(!m||!d)return;i.ttl=m,i.start=d,i.now=n||o();const s=i.now-d;i.remainingTTL=m-s}});let n=0;const o=()=>{const i=Xe.now();if(this.ttlResolution>0){n=i;const a=setTimeout(()=>n=0,this.ttlResolution);a.unref&&a.unref()}return i};this.getRemainingTTL=i=>{const a=c(this,X).get(i);if(a===void 0)return 0;const m=t[a],d=l[a];if(!m||!d)return 1/0;const s=(n||o())-d;return m-s},x(this,de,i=>{const a=l[i],m=t[i];return!!m&&!!a&&(n||o())-a>m})},Ve=new WeakMap,Le=new WeakMap,dt=new WeakMap,de=new WeakMap,xt=new WeakSet,Mn=function(){const t=new Ct(c(this,pe));x(this,ke,0),x(this,we,t),x(this,We,l=>{x(this,ke,c(this,ke)-t[l]),t[l]=0}),x(this,ht,(l,n,o,i)=>{if(E(this,D,j).call(this,n))return 0;if(!Oe(o))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(o=i(n,l),!Oe(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o}),x(this,nt,(l,n,o)=>{if(t[l]=n,c(this,re)){const i=c(this,re)-t[l];for(;c(this,ke)>i;)E(this,ot,wt).call(this,!0)}x(this,ke,c(this,ke)+t[l]),o&&(o.entrySize=n,o.totalCalculatedSize=c(this,ke))})},We=new WeakMap,nt=new WeakMap,ht=new WeakMap,Se=new WeakSet,Pe=function*({allowStale:t=this.allowStale}={}){if(c(this,Y))for(let l=c(this,J);!(!E(this,mt,Zt).call(this,l)||((t||!c(this,de).call(this,l))&&(yield l),l===c(this,le)));)l=c(this,ce)[l]},Ee=new WeakSet,De=function*({allowStale:t=this.allowStale}={}){if(c(this,Y))for(let l=c(this,le);!(!E(this,mt,Zt).call(this,l)||((t||!c(this,de).call(this,l))&&(yield l),l===c(this,J)));)l=c(this,ne)[l]},mt=new WeakSet,Zt=function(t){return t!==void 0&&c(this,X).get(c(this,z)[t])===t},ot=new WeakSet,wt=function(t){var i,a;const l=c(this,le),n=c(this,z)[l],o=c(this,A)[l];return c(this,Be)&&E(this,D,j).call(this,o)?o.__abortController.abort(new Error("evicted")):(c(this,Te)||c(this,oe))&&(c(this,Te)&&((i=c(this,be))==null||i.call(this,o,n,"evict")),c(this,oe)&&((a=c(this,Q))==null||a.push([o,n,"evict"]))),c(this,We).call(this,l),t&&(c(this,z)[l]=void 0,c(this,A)[l]=void 0,c(this,Ce).push(l)),c(this,Y)===1?(x(this,le,x(this,J,0)),c(this,Ce).length=0):x(this,le,c(this,ne)[l]),c(this,X).delete(n),vt(this,Y)._--,l},it=new WeakSet,$t=function(t,l,n,o){const i=l===void 0?void 0:c(this,A)[l];if(E(this,D,j).call(this,i))return i;const a=new Et,{signal:m}=n;m==null||m.addEventListener("abort",()=>a.abort(m.reason),{signal:a.signal});const d={signal:a.signal,options:n,context:o},s=(y,v=!1)=>{const{aborted:g}=a.signal,b=n.ignoreFetchAbort&&y!==void 0;if(n.status&&(g&&!v?(n.status.fetchAborted=!0,n.status.fetchError=a.signal.reason,b&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),g&&!b&&!v)return f(a.signal.reason);const T=C;return c(this,A)[l]===C&&(y===void 0?T.__staleWhileFetching?c(this,A)[l]=T.__staleWhileFetching:this.delete(t):(n.status&&(n.status.fetchUpdated=!0),this.set(t,y,d.options))),y},r=y=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=y),f(y)),f=y=>{const{aborted:v}=a.signal,g=v&&n.allowStaleOnFetchAbort,b=g||n.allowStaleOnFetchRejection,T=b||n.noDeleteOnFetchRejection,_=C;if(c(this,A)[l]===C&&(!T||_.__staleWhileFetching===void 0?this.delete(t):g||(c(this,A)[l]=_.__staleWhileFetching)),b)return n.status&&_.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),_.__staleWhileFetching;if(_.__returned===_)throw y},w=(y,v)=>{var b;const g=(b=c(this,lt))==null?void 0:b.call(this,t,i,d);g&&g instanceof Promise&&g.then(T=>y(T===void 0?void 0:T),v),a.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(y(void 0),n.allowStaleOnFetchAbort&&(y=T=>s(T,!0)))})};n.status&&(n.status.fetchDispatched=!0);const C=new Promise(w).then(s,r),p=Object.assign(C,{__abortController:a,__staleWhileFetching:i,__returned:void 0});return l===void 0?(this.set(t,p,{...d.options,status:void 0}),l=c(this,X).get(t)):c(this,A)[l]=p,p},D=new WeakSet,j=function(t){if(!c(this,Be))return!1;const l=t;return!!l&&l instanceof Promise&&l.hasOwnProperty("__staleWhileFetching")&&l.__abortController instanceof Et},ft=new WeakSet,Xt=function(t,l){c(this,ce)[l]=t,c(this,ne)[t]=l},Ue=new WeakSet,at=function(t){t!==c(this,J)&&(t===c(this,le)?x(this,le,c(this,ne)[t]):E(this,ft,Xt).call(this,c(this,ce)[t],c(this,ne)[t]),E(this,ft,Xt).call(this,c(this,J),t),x(this,J,t))};let qt=Qt;const Po=(e,t)=>{const l=O("editorId"),{noImgZoomIn:n}=e;let o=()=>{};H([t,je(e.setting,"preview")],()=>{!n&&e.setting.preview&&o()},{immediate:!0}),q(()=>{o=At(()=>{const i=document.querySelectorAll(`#${l}-preview img`);i.length!==0&&ho(i,{background:"#00000073"})})})},Do=(e,t)=>{if(typeof t[e]=="string")return t[e];const l=`<i class="${h}-iconfont ${h}-icon-${e}"></i>`;switch(Z.iconfontType){case"svg":return`<svg class="${h}-icon" aria-hidden="true"><use xlink:href="#${h}-icon-${e}"></use></svg>`;default:return l}},No=(e,t,l)=>{const n=O("editorId"),o=O("usedLanguageText"),i=O("customIcon"),a=()=>{document.querySelectorAll(`#${n}-preview pre`).forEach(s=>{var r,f;let w=-1;(r=s.querySelector(".copy-button"))==null||r.remove();const C=((f=o.value.copyCode)==null?void 0:f.text)||"复制代码",p=document.createElement("span");p.setAttribute("class","copy-button"),p.dataset.tips=C,p.innerHTML=Do("copy",i.value),p.addEventListener("click",()=>{var y,v;clearTimeout(w);const g=s.querySelector("code").innerText,b=mo(e.formatCopiedText(g)),T=((y=o.value.copyCode)==null?void 0:y.successTips)||"已复制！",_=((v=o.value.copyCode)==null?void 0:v.failTips)||"已复制！";p.dataset.tips=b?T:_,w=window.setTimeout(()=>{p.dataset.tips=C},1500)}),s.appendChild(p)})},m=()=>{Fe(a)},d=s=>{s&&Fe(a)};H([t,l],m),H(()=>e.setting.preview,d),H(()=>e.setting.htmlPreview,d),H(()=>o.value,a),q(a)},Bo=e=>{var t;const l=(t=Z.editorExtensions)==null?void 0:t.highlight,n=l==null?void 0:l.instance,o=O("highlight"),i=Ge(n);return q(()=>{if(!e.noHighlight&&!i.value){const a=document.createElement("script");a.src=o.value.js,a.onload=()=>{i.value=window.hljs},a.id=`${h}-hljs`,fe(a,"hljs");const m=document.createElement("link");m.rel="stylesheet",m.href=o.value.css,m.id=`${h}-hlCss`,fe(m)}}),H(()=>o.value.css,a=>{Ho(`${h}-hlCss`,"href",a)}),i},jo=e=>{const t=O("theme"),{editorExtensions:l,mermaidConfig:n}=Z,o=l==null?void 0:l.mermaid,i=Ge(o==null?void 0:o.instance),a=Ge(-1),m=new qt({max:1e3,ttl:6e5}),d=()=>{const r=i.value;!e.noMermaid&&r&&(r.initialize(n({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"})),a.value=a.value+1)};return H(()=>t.value,()=>{m.clear(),d()}),q(()=>{if(!e.noMermaid&&!(o!=null&&o.instance)){const r=(o==null?void 0:o.js)||wo;if(/\.mjs/.test(r))Yn(()=>import(r),__vite__mapDeps([])).then(f=>{i.value=f.default,d()});else{const f=document.createElement("script");f.id=`${h}-mermaid`,f.src=r,f.onload=()=>{i.value=window.mermaid,d()},fe(f,"mermaid")}}}),{mermaidRef:i,reRenderRef:a,replaceMermaid:()=>{Fe(()=>{if(!e.noMermaid&&i.value){const r=document.querySelectorAll(`div.${h}-mermaid`),f=document.createElement("div");f.style.width=document.body.offsetWidth+"px",f.style.height=document.body.offsetHeight+"px",f.style.position="fixed",f.style.zIndex="-10000",f.style.top="-10000";let w=r.length;w>0&&document.body.appendChild(f),r.forEach(async C=>{let p=m.get(C.innerText);if(!p){const v=jt(),g=i.value.renderAsync||i.value.render;let b="";try{b=await g(v,C.innerText,f)}catch{}p=await e.sanitizeMermaid(typeof b=="string"?b:b.svg),m.set(C.innerText,p)}const y=document.createElement("p");y.className=`${h}-mermaid`,y.setAttribute("data-processed",""),y.innerHTML=p,C.dataset.line!==void 0&&(y.dataset.line=C.dataset.line),C.replaceWith(y),--w===0&&f.remove()})}})}}},zo=e=>{var t;const l=(t=Z.editorExtensions)==null?void 0:t.katex,n=l==null?void 0:l.instance,o=Ge(n);return q(()=>{if(!e.noKatex&&!o.value){const i=document.createElement("script");i.src=(l==null?void 0:l.js)||Zl.js,i.onload=()=>{o.value=window.katex},i.id=`${h}-katex`;const a=document.createElement("link");a.rel="stylesheet",a.href=(l==null?void 0:l.css)||Zl.css,a.id=`${h}-katexCss`,fe(i,"katex"),fe(a)}}),o},Vo=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(n,o,i,a,m)=>{const d=n[o],s=d.content.trim();if(d.info==="mermaid"){let r;return n[o].map&&n[o].level===0&&(r=n[o].map[0],n[o].attrSet("data-line",String(r))),`<div class="${h}-mermaid" ${r!==void 0?"data-line="+r:""} data-mermaid-theme=${t.themeRef.value}>${s}</div>`}return l(n,o,i,a,m)}},Wo=Vo,an=(e,t)=>{let l=!0,n=!0;const o=e.posMax,i=t>0?e.src.charCodeAt(t-1):-1,a=t+1<=o?e.src.charCodeAt(t+1):-1;return(i===32||i===9||a>=48&&a<=57)&&(n=!1),(a===32||a===9)&&(l=!1),{can_open:l,can_close:n}},Uo=(e,t)=>{let l,n,o,i;if(e.src[e.pos]!=="$")return!1;if(o=an(e,e.pos),!o.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const a=e.pos+1;for(l=a;(l=e.src.indexOf("$",l))!==-1;){for(i=l-1;e.src[i]==="\\";)i-=1;if((l-i)%2==1)break;l+=1}return l===-1?(t||(e.pending+="$"),e.pos=a,!0):l-a===0?(t||(e.pending+="$$"),e.pos=a+1,!0):(o=an(e,l),o.can_close?(t||(n=e.push("math_inline","math",0),n.markup="$",n.content=e.src.slice(a,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=a,!0))},Go=(e,t,l,n)=>{let o,i,a,m,d=!1,s=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];if(s+2>r||e.src.slice(s,s+2)!=="$$")return!1;if(s+=2,o=e.src.slice(s,r),n)return!0;for(o.trim().slice(-2)==="$$"&&(o=o.trim().slice(0,-2),d=!0),a=t;!d&&(a++,!(a>=l||(s=e.bMarks[a]+e.tShift[a],r=e.eMarks[a],s<r&&e.tShift[a]<e.blkIndent)));)e.src.slice(s,r).trim().slice(-2)==="$$"&&(m=e.src.slice(0,r).lastIndexOf("$$"),i=e.src.slice(s,m),d=!0);e.line=a+1;const f=e.push("math_block","math",0);return f.block=!0,f.content=(o&&o.trim()?o+`
`:"")+e.getLines(t+1,a,e.tShift[t],!0)+(i&&i.trim()?i:""),f.map=[t,e.line],f.markup="$$",!0},qo=(e,t)=>{const l=o=>{if(t.katexRef.value){const i=t.katexRef.value.renderToString(o,{throwOnError:!1});return`<span class="${h}-katex-inline" data-processed>${i}</span>`}else return`<span class="${h}-katex-inline">${o}</span>`},n=(o,i)=>{if(t.katexRef.value){const a=t.katexRef.value.renderToString(o,{throwOnError:!1,displayMode:!0});return`<p class="${h}-katex-block" data-line=${i} data-processed>${a}</p>`}else return`<p class="${h}-katex-block" data-line=${i}>${o}</p>`};e.inline.ruler.after("escape","math_inline",Uo),e.block.ruler.after("blockquote","math_block",Go,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(o,i)=>l(o[i].content),e.renderer.rules.math_block=(o,i)=>n(o[i].content,o[i].map[0])+`
`},Ko=qo,Zo=(e,t)=>{t=t||{};const l=3,n=t.marker||"!",o=n.charCodeAt(0),i=n.length;let a="",m="";const d=(r,f,w,C,p)=>{const y=r[f];return y.type==="admonition_open"?(r[f].attrPush(["class",`${h}-admonition ${h}-admonition-${y.info}`]),r[f].attrSet("data-line",String(r[f].map[0]))):y.type==="admonition_title_open"&&r[f].attrPush(["class",`${h}-admonition-title`]),p.renderToken(r,f,w)},s=r=>{const f=r.trim().split(" ",2);m="",a=f[0],f.length>1&&(m=r.substring(a.length+2)),(m===""||!m)&&(m=a)};e.block.ruler.before("code","admonition",(r,f,w,C)=>{let p,y,v,g=!1,b=r.bMarks[f]+r.tShift[f],T=r.eMarks[f];if(o!==r.src.charCodeAt(b))return!1;for(p=b+1;p<=T&&n[(p-b)%i]===r.src[p];p++);const _=Math.floor((p-b)/i);if(_!==l)return!1;p-=(p-b)%i;const S=r.src.slice(b,p),L=r.src.slice(p,T);if(s(L),C)return!0;for(y=f;y++,!(y>=w||(b=r.bMarks[y]+r.tShift[y],T=r.eMarks[y],b<T&&r.sCount[y]<r.blkIndent));)if(o===r.src.charCodeAt(b)&&!(r.sCount[y]-r.blkIndent>=4)){for(p=b+1;p<=T&&n[(p-b)%i]===r.src[p];p++);if(!(Math.floor((p-b)/i)<_)&&(p-=(p-b)%i,p=r.skipSpaces(p),!(p<T))){g=!0;break}}const F=r.parentType,N=r.lineMax;return r.parentType="root",r.lineMax=y,v=r.push("admonition_open","div",1),v.markup=S,v.block=!0,v.info=a,v.map=[f,y],v=r.push("admonition_title_open","p",1),v.markup=S+" "+a,v.map=[f,y],v=r.push("inline","",0),v.content=m,v.map=[f,r.line-1],v.children=[],v=r.push("admonition_title_close","p",-1),v.markup=S+" "+a,r.md.block.tokenize(r,f+1,y),v=r.push("admonition_close","div",-1),v.markup=r.src.slice(b,p),v.block=!0,r.parentType=F,r.lineMax=N,r.line=y+(g?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=d,e.renderer.rules.admonition_title_open=d,e.renderer.rules.admonition_title_close=d,e.renderer.rules.admonition_close=d},Xo=Zo,Yo=(e,t)=>{e.renderer.rules.heading_open=(l,n)=>{var o;const i=l[n],a=((o=l[n+1].children)==null?void 0:o.reduce((d,s)=>d+(s.content||""),""))||"",m=i.markup.length;return t.headsRef.value.push({text:a,level:m}),i.map&&i.level===0&&(i.attrSet("data-line",String(i.map[0])),i.attrSet("id",t.mdHeadingId(a,m,t.headsRef.value.length))),e.renderer.renderToken(l,n,t)},e.renderer.rules.heading_close=(l,n,o,i,a)=>a.renderToken(l,n,o)},Jo=Yo,Qo=(e,t)=>{const l=e.renderer.rules.fence,n=e.utils.unescapeAll,o=/\[(\w*)(?::([\w ]*))?\]/;function i(s){return s.info?n(s.info).trim():""}function a(s){const r=i(s),[f=null,w=""]=(o.exec(r)||[]).slice(1);return[f,w]}function m(s){const r=i(s);return r?r.split(/(\s+)/g)[0]:""}const d=(s,r,f,w,C)=>{if(s[r].hidden)return"";const[p,y]=a(s[r]);if(p===null)return l(s,r,f,w,C);let v,g,b,T,_="",S="";for(let L=r;L<s.length&&(v=s[L],[g,b]=a(v),g===p);L++)v.info=v.info.replace(o,""),v.hidden=!0,T=L-r>0?"":" checked",_+=`<li><input type="radio" name="label-group-${t.editorId}-${r}"${T}><label for="group-${t.editorId}-${r}-tab-${L-r}" onclick="this.previousElementSibling.click()">${b||m(v)}</label></li>
`,S+=`<input type="radio" id="group-${t.editorId}-${r}-tab-${L-r}" name="group-${t.editorId}-${r}"${T}>
`+l(s,L,f,w,C);return`<div class="code-tabs">
<ul>
`+_+`</ul>
`+S+"</div>"};e.renderer.rules.fence=d},ei=Qo,ti=e=>{["paragraph_open","table_open","ordered_list_open","bullet_list_open","blockquote_open","hr","html_block","fence"].forEach(t=>{const l=e.renderer.rules[t];l?e.renderer.rules[t]=(n,o,i,a,m)=>{let d;const s=l(n,o,i,a,m);return n[o].map&&n[o].level===0&&!/^<!--/.test(s)?(d=n[o].map[0],s.replace(/^(<[^>]*)/,`$1 data-line="${d}"`)):s}:e.renderer.rules[t]=(n,o,i,a,m)=>{let d;return n[o].map&&n[o].level===0&&(d=n[o].map[0],n[o].attrSet("data-line",String(d))),m.renderToken(n,o,i)}})},li=(e,t)=>{const{editorConfig:l,markdownItConfig:n,markdownItPlugins:o}=Z,i=O("editorId"),a=O("showCodeRowNumber"),m=O("theme"),d=G([]),s=Bo(e),r=zo(e),{reRenderRef:f,replaceMermaid:w}=jo(e),C=fo({html:!0,breaks:!0});n(C,{editorId:i});const p=[{type:"katex",plugin:Ko,options:{katexRef:r}},{type:"image",plugin:go,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Xo,options:{}},{type:"taskList",plugin:vo,options:{}},{type:"heading",plugin:Jo,options:{mdHeadingId:e.mdHeadingId,headsRef:d}},{type:"codeTabs",plugin:ei,options:{editorId:i}},{type:"xss",plugin:po,options:{xss(S){return{whiteList:Object.assign({},S.getDefaultWhiteList(),{input:["class","disabled","type","checked"],iframe:["class","width","height","src","title","border","frameborder","framespacing","allow","allowfullscreen"]})}}}}];e.noMermaid||p.push({type:"mermaid",plugin:Wo,options:{themeRef:m}}),o(p,{editorId:i}).forEach(S=>{C.use(S.plugin,S.options)});const y=C.options.highlight;C.set({highlight:(S,L,F)=>{if(y){const P=y(S,L,F);if(P)return P}let N;!e.noHighlight&&s.value?s.value.getLanguage(L)?N=s.value.highlight(S,{language:L,ignoreIllegals:!0}).value:N=s.value.highlightAuto(S).value:N=C.utils.escapeHtml(S);const B=a?Io(N.replace(/^\n+|\n+$/g,"")):`<span class="code-block">${N.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${L}" language=${L}>${B}</code></pre>`}}),ti(C);const v=G(`_article-key_${jt()}`),g=G(e.sanitize(C.render(e.modelValue))),b=()=>{$.emit(i,kt,g.value),e.onHtmlChanged(g.value),e.onGetCatalog(d.value),$.emit(i,Wt,d.value),w()};q(b);const T=()=>{d.value=[],g.value=e.sanitize(C.render(e.modelValue)),b()},_=he(()=>(e.noKatex||r.value)&&(e.noHighlight||s.value));return H([je(e,"modelValue"),_,f],At(T,(l==null?void 0:l.renderDelay)!==void 0?l==null?void 0:l.renderDelay:t?0:500)),q(()=>{$.on(i,{name:An,callback(){$.emit(i,Wt,d.value)}}),$.on(i,{name:Jt,callback:()=>{T(),v.value=`_article-key_${jt()}`}})}),{html:g,key:v}},ni=li,Rn={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({preview:!0})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function}},oi={...Rn,updateModelValue:{type:Function,default:()=>{}},onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function}},On=K({name:"ContentPreview",props:Rn,setup(e){const t=O("editorId"),l=O("previewTheme"),n=O("showCodeRowNumber"),{html:o,key:i}=ni(e,e.previewOnly);return No(e,o,i),Po(e,o),()=>u(It,null,[e.setting.preview&&u("div",{id:`${t}-preview-wrapper`,class:`${h}-preview-wrapper`,key:"content-preview-wrapper"},[u("div",{key:i.value,id:`${t}-preview`,class:[`${h}-preview`,`${l==null?void 0:l.value}-theme`,n&&`${h}-scrn`],innerHTML:o.value},null)]),!e.previewOnly&&e.setting.htmlPreview&&u("div",{id:`${t}-html-wrapper`,class:`${h}-preview-wrapper`,key:"html-preview-wrapper"},[u("div",{class:`${h}-html`},[o.value])])])}}),ii=(e,t)=>{const{editorId:l}=e,n=ae({buildFinished:!1,html:""});H(()=>e.modelValue,()=>{n.buildFinished=!1}),q(()=>{$.on(l,{name:kt,callback(o){n.buildFinished=!0,n.html=o}}),$.on(l,{name:Lt,callback(){const o=new Promise(i=>{if(n.buildFinished)i(n.html);else{const a=m=>{i(m),$.remove(l,kt,a)};$.on(l,{name:kt,callback:a})}});e.onSave?e.onSave(e.modelValue,o):t.emit("onSave",e.modelValue,o)}})})},Pn=e=>{var t,l;const{editorId:n}=e,o=(l=(t=Z)==null?void 0:t.editorExtensions)==null?void 0:l.highlight;Ae("editorId",n),Ae("theme",he(()=>e.theme)),Ae("language",he(()=>e.language)),Ae("highlight",he(()=>{const a={...Xl,...o==null?void 0:o.css},m=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme;return{js:(o==null?void 0:o.js)||ko,css:a[e.codeTheme]?a[e.codeTheme][m]:Xl.atom[m]}})),Ae("showCodeRowNumber",e.showCodeRowNumber);const i=he(()=>{var a,m;const d={...Kl,...(m=(a=Z)==null?void 0:a.editorConfig)==null?void 0:m.languageUserDefined};return d[e.language]?d[e.language]:Kl["zh-CN"]});Ae("usedLanguageText",i),Ae("previewTheme",he(()=>e.previewTheme)),Ae("customIcon",he(()=>e.customIcon))},ai=e=>{Pn(e),Ae("tabWidth",e.tabWidth)},Dn=e=>{q(()=>{var t,l;if(!e.noIconfont)if(Z.iconfontType==="svg"){const n=document.createElement("script");n.src=((t=Z.editorExtensions)==null?void 0:t.iconfont)||bo,n.id=`${h}-icon`,fe(n)}else{const n=document.createElement("link");n.rel="stylesheet",n.href=((l=Z.editorExtensions)==null?void 0:l.iconfontClass)||yo,n.id=`${h}-icon-class`,fe(n)}})},si=e=>{var t,l,n,o,i,a;const{noPrettier:m,noUploadImg:d}=e,{editorExtensions:s}=Z,r=m||!!((l=(t=Z.editorExtensions)==null?void 0:t.prettier)!=null&&l.prettierInstance),f=m||!!((o=(n=Z.editorExtensions)==null?void 0:n.prettier)!=null&&o.parserMarkdownInstance),w=d||!!((a=(i=Z.editorExtensions)==null?void 0:i.cropper)!=null&&a.instance);q(()=>{var C,p,y,v;const g=document.createElement("script"),b=document.createElement("script");g.src=((C=s==null?void 0:s.prettier)==null?void 0:C.standaloneJs)||Gl.main,g.id=`${h}-prettier`,b.src=((p=s==null?void 0:s.prettier)==null?void 0:p.parserMarkdownJs)||Gl.markdown,b.id=`${h}-prettierMD`;const T=document.createElement("link");T.rel="stylesheet",T.href=((y=s==null?void 0:s.cropper)==null?void 0:y.css)||ql.css,T.id=`${h}-cropperCss`;const _=document.createElement("script");_.src=((v=s==null?void 0:s.cropper)==null?void 0:v.js)||ql.js,_.id=`${h}-cropper`,w||(fe(T),fe(_)),r||fe(g),f||fe(b)}),Dn(e)},ri=(e,t)=>{const{editorId:l}=e;q(()=>{$.on(l,{name:qe,callback:n=>{e.onError instanceof Function?e.onError(n):t.emit("onError",n)}})})},ci=(e,t)=>{const{editorId:l}=e,n=ae({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview}),o=(m,d)=>{n[m]=d===void 0?!n[m]:d,m==="preview"&&n.preview?n.htmlPreview=!1:m==="htmlPreview"&&n.htmlPreview&&(n.preview=!1)};let i="";const a=()=>{n.pageFullscreen||n.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=i};return H(()=>[n.pageFullscreen,n.fullscreen],a),q(()=>{$.on(l,{name:Ft,callback(m,d){const s=r=>{$.emit(l,V,"image",{desc:"",urls:r}),d&&d()};e.onUploadImg?e.onUploadImg(m,s):t.emit("onUploadImg",m,s)}}),i=document.body.style.overflow,a()}),[n,o]},ui=e=>{const{editorId:t}=e,l=G(!1);return q(()=>{$.on(t,{name:Yt,callback:o=>{o===void 0?l.value=!l.value:l.value=o}})}),he(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&l.value)},di=(e,t,l,n,o,i)=>{const{editorId:a}=e;H(()=>n.pageFullscreen,d=>{$.emit(a,Yl,d)}),H(()=>n.fullscreen,d=>{$.emit(a,Jl,d)}),H(()=>n.preview,d=>{$.emit(a,Ql,d)}),H(()=>n.htmlPreview,d=>{$.emit(a,en,d)}),H(l,d=>{$.emit(a,tn,d)});const m={on(d,s){switch(d){case"pageFullscreen":{$.on(a,{name:Yl,callback(r){s(r)}});break}case"fullscreen":{$.on(a,{name:Jl,callback(r){s(r)}});break}case"preview":{$.on(a,{name:Ql,callback(r){s(r)}});break}case"htmlPreview":{$.on(a,{name:en,callback(r){s(r)}});break}case"catalog":{$.on(a,{name:tn,callback(r){s(r)}});break}}},togglePageFullscreen(d){o("pageFullscreen",d)},toggleFullscreen(d){$.emit(a,Sn,d)},togglePreview(d){o("preview",d)},toggleHtmlPreview(d){o("htmlPreview",d)},toggleCatalog(d){$.emit(a,Yt,d)},triggerSave(){$.emit(a,Lt)},insert(d){$.emit(a,V,"universal",{generate:d})},focus(d){var s;(s=i.value)==null||s.focus(d)},rerender(){$.emit(a,Jt)},getSelectedText(){var d;return(d=i.value)==null?void 0:d.getSelectedText()},resetHistory(){var d;(d=i.value)==null||d.resetHistory()},domEventHandlers(d){$.emit(a,In,d)}};t.expose(m)},hi=e=>e,Nn={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:()=>Fo("md-editor-v3_")},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:hi},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)}},mi={...Nn,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:Tn},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array,default:()=>[6,4]},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:_n},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function}},Bn=["onHtmlChanged","onGetCatalog"],fi=[...Bn,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],gi=(e,t)=>{const{editorId:l}=e,n={rerender(){$.emit(l,Jt)}};t.expose(n)},Tt=K({name:"MdPreview",props:Nn,emits:Bn,setup(e,t){const{editorId:l,noKatex:n,noMermaid:o,noHighlight:i}=e;return Pn(e),Dn(e),gi(e,t),gt(()=>{$.clear(l)}),()=>u("div",{id:l,class:[h,e.class,e.theme==="dark"&&`${h}-dark`,`${h}-previewOnly`],style:e.style},[u(On,{modelValue:e.modelValue,onHtmlChanged:a=>{e.onHtmlChanged?e.onHtmlChanged(a):t.emit("onHtmlChanged",a)},onGetCatalog:a=>{e.onGetCatalog?e.onGetCatalog(a):t.emit("onGetCatalog",a)},mdHeadingId:e.mdHeadingId,noMermaid:o,sanitize:e.sanitize,noKatex:n,formatCopiedText:e.formatCopiedText,noHighlight:i,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid},null)])}});Tt.install=e=>(e.component(Tt.name,Tt),e);const vi={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},jn=K({props:vi,setup(e){return()=>{const{tocItem:t,mdHeadingId:l,scrollElement:n,onClick:o,scrollElementOffsetTop:i}=e;return u("div",{class:[`${h}-catalog-link`,t.active&&`${h}-catalog-active`],onClick:a=>{o(a,t),a.stopPropagation();const m=l(t.text,t.level,t.index),d=document.getElementById(m),s=n instanceof Element?n:document.querySelector(n);if(d&&s){let r=d.offsetParent,f=d.offsetTop;if(s.contains(r))for(;r&&s!=r;)f+=r==null?void 0:r.offsetTop,r=r==null?void 0:r.offsetParent;s==null||s.scrollTo({top:f-i,behavior:"smooth"})}}},[u("span",{title:t.text},[t.text]),u("div",{class:`${h}-catalog-wrapper`},[t.children&&t.children.map(a=>u(jn,{mdHeadingId:l,key:`${t.text}-link-${a.level}-${a.text}`,tocItem:a,scrollElement:n,onClick:o,scrollElementOffsetTop:i},null))])])}}}),pi=jn,bi={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function}},ct=K({name:"MdCatalog",props:bi,emits:["onClick","onActive"],setup(e,t){const l=e.editorId,n=ae({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),o=Ge(),i=he(()=>{const s=[];return n.list.forEach((r,f)=>{const{text:w,level:C}=r,p={level:C,text:w,index:f+1,active:o.value===r};if(s.length===0)s.push(p);else{let y=s[s.length-1];if(p.level>y.level)for(let v=y.level+1;v<=6;v++){const{children:g}=y;if(!g){y.children=[p];break}if(y=g[g.length-1],p.level<=y.level){g.push(p);break}}else s.push(p)}}),s}),a=()=>n.scrollElement instanceof HTMLElement?n.scrollElement:document.querySelector(n.scrollElement),m=s=>{if(s.length===0)return n.list=[],!1;const{activeHead:r}=s.reduce((f,w,C)=>{const p=document.getElementById(e.mdHeadingId(w.text,w.level,C+1));if(p instanceof HTMLElement){const y=a(),v=Lo(p,y);if(v<e.offsetTop&&v>f.minTop)return{activeHead:w,minTop:v}}return f},{activeHead:s[0],minTop:Number.MIN_SAFE_INTEGER});o.value=r,n.list=s},d=()=>{m(n.list)};return H(()=>o.value,s=>{const r=s?{...s}:void 0;e.onActive?e.onActive(r):t.emit("onActive",r)}),q(()=>{const s=a(),r=s===document.documentElement?window:s;r==null||r.addEventListener("scroll",d),$.on(l,{name:Wt,callback:f=>{r==null||r.removeEventListener("scroll",d),m(f),r==null||r.addEventListener("scroll",d)}}),$.emit(l,An)}),gt(()=>{var s;const r=a();(s=r===document.documentElement?window:r)==null||s.removeEventListener("scroll",d)}),()=>u("div",{class:`${h}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[i.value.map(s=>u(pi,{mdHeadingId:e.mdHeadingId,tocItem:s,key:`link-${s.level}-${s.text}`,scrollElement:n.scrollElement,onClick:(r,f)=>{e.onClick?e.onClick(r,f):t.emit("onClick",r,f)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}});ct.install=e=>(e.component(ct.name,ct),e);const yi={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},_t=K({name:"NormalToolbar",props:yi,emits:["onClick"],setup(e,t){return()=>{const l=ge({props:e,ctx:t},"trigger");return u("div",{class:`${h}-toolbar-item`,title:e.title,onClick:n=>{e.onClick instanceof Function?e.onClick(n):t.emit("onClick",n)}},[l])}}});_t.install=e=>(e.component(_t.name,_t),e);function ki(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Xn(e)}const Ci={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},St=K({name:"ModalToolbar",props:Ci,emits:["onClick","onClose","onAdjust"],setup(e,t){return()=>{const l=ge({props:e,ctx:t},"trigger"),n=ge({props:e,ctx:t},"default");return u(It,null,[u("div",{class:`${h}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[l]),u(et,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:o=>{e.onAdjust instanceof Function?e.onAdjust(o):t.emit("onAdjust",o)}},ki(n)?n:{default:()=>[n]})])}}});St.install=e=>(e.component(St.name,St),e);var wi=Object.defineProperty,$i=(e,t,l)=>t in e?wi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,Re=(e,t,l)=>($i(e,typeof t!="symbol"?t+"":t,l),l);const Ti=K({setup(){return()=>u("div",{class:`${h}-divider`},null)}}),_i={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},Si=e=>{var t,l,n,o;const i=O("editorId");let a=(l=(t=Z.editorExtensions)==null?void 0:t.screenfull)==null?void 0:l.instance;const m=(o=(n=Z.editorExtensions)==null?void 0:n.screenfull)==null?void 0:o.js,d=G(!1),s=w=>{if(!a){$.emit(i,qe,{name:"fullscreen",message:"fullscreen is undefined"});return}a.isEnabled?(d.value=!0,(w===void 0?!a.isFullscreen:w)?a.request():a.exit()):console.error("browser does not support screenfull!")},r=()=>{a&&a.isEnabled&&a.on("change",()=>{(d.value||e.setting.fullscreen)&&(d.value=!1,e.updateSetting("fullscreen"))})},f=()=>{a=window.screenfull,r()};return q(()=>{if(r(),!a){const w=document.createElement("script");w.src=m||Co,w.onload=f,w.id=`${h}-screenfull`,fe(w,"screenfull")}}),q(()=>{$.on(i,{name:Sn,callback:s})}),{fullscreenHandler:s}},Ei={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},xi=K({name:"TableShape",props:Ei,setup(e){const t=ae({x:-1,y:-1});return()=>u("div",{class:`${h}-table-shape`,onMouseleave:()=>{t.x=-1,t.y=-1}},[new Array(e.tableShape[1]).fill("").map((l,n)=>u("div",{class:`${h}-table-shape-row`,key:`table-shape-row-${n}`},[new Array(e.tableShape[0]).fill("").map((o,i)=>u("div",{class:`${h}-table-shape-col`,key:`table-shape-col-${i}`,onMouseenter:()=>{t.x=n,t.y=i},onClick:()=>{e.onSelected(t)}},[u("div",{class:[`${h}-table-shape-col-default`,n<=t.x&&i<=t.y&&`${h}-table-shape-col-include`]},null)]))]))])}}),Ai=xi,Ii={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Li=K({props:Ii,setup(e){const t=O("usedLanguageText"),l=O("editorId"),n=he(()=>{var i,a;switch(e.type){case"link":return(i=t.value.linkModalTips)==null?void 0:i.linkTitle;case"image":return(a=t.value.linkModalTips)==null?void 0:a.imageTitle;default:return""}}),o=ae({desc:"",url:""});return H(()=>e.visible,i=>{i||setTimeout(()=>{o.desc="",o.url=""},200)}),()=>u(et,{title:n.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var i,a,m,d,s;return[u("div",{class:`${h}-form-item`},[u("label",{class:`${h}-label`,for:`link-desc-${l}`},[(i=t.value.linkModalTips)==null?void 0:i.descLabel]),u("input",{placeholder:(a=t.value.linkModalTips)==null?void 0:a.descLabelPlaceHolder,class:`${h}-input`,id:`link-desc-${l}`,type:"text",value:o.desc,onChange:r=>{o.desc=r.target.value},autocomplete:"off"},null)]),u("div",{class:`${h}-form-item`},[u("label",{class:`${h}-label`,for:`link-url-${l}`},[(m=t.value.linkModalTips)==null?void 0:m.urlLabel]),u("input",{placeholder:(d=t.value.linkModalTips)==null?void 0:d.urlLabelPlaceHolder,class:`${h}-input`,id:`link-url-${l}`,type:"text",value:o.url,onChange:r=>{o.url=r.target.value},autocomplete:"off"},null)]),u("div",{class:`${h}-form-item`},[u("button",{class:[`${h}-btn`,`${h}-btn-row`],type:"button",onClick:()=>{e.onOk(o),o.desc="",o.url=""}},[(s=t.value.linkModalTips)==null?void 0:s.buttonOK])])]}})}}),Fi={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Hi=K({props:Fi,setup(e){var t,l,n;const o=O("usedLanguageText"),i=O("editorId");let a=(n=(l=(t=Z)==null?void 0:t.editorExtensions)==null?void 0:l.cropper)==null?void 0:n.instance;const m=G(),d=G(),s=G(),r=ae({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let f=null;H(()=>e.visible,()=>{e.visible&&!r.cropperInited&&(a=a||window.Cropper,m.value.onchange=()=>{if(!a){$.emit(i,qe,{name:"Cropper",message:"Cropper is undefined"});return}const C=m.value.files||[];if(r.imgSelected=!0,(C==null?void 0:C.length)>0){const p=new FileReader;p.onload=y=>{r.imgSrc=y.target.result,Fe(()=>{f=new a(d.value,{viewMode:2,preview:`.${h}-clip-preview-target`})})},p.readAsDataURL(C[0])}})}),H(()=>[r.imgSelected],()=>{s.value.style=""}),H(()=>r.isFullscreen,()=>{Fe(()=>{f==null||f.destroy(),s.value.style="",d.value&&(f=new a(d.value,{viewMode:2,preview:`.${h}-clip-preview-target`}))})});const w=()=>{f.clear(),f.destroy(),f=null,m.value.value="",r.imgSelected=!1};return()=>{var C;return u(et,{class:`${h}-modal-clip`,title:(C=o.value.clipModalTips)==null?void 0:C.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:r.isFullscreen,onAdjust:p=>{r.isFullscreen=p},width:"668px",height:"421px"},{default:()=>{var p,y;return[u("div",{class:`${h}-form-item ${h}-clip`},[u("div",{class:`${h}-clip-main`},[r.imgSelected?u("div",{class:`${h}-clip-cropper`},[u("img",{src:r.imgSrc,ref:d,style:{display:"none"},alt:""},null),u("div",{class:`${h}-clip-delete`,onClick:w},[u(M,{name:"delete"},null)])]):u("div",{class:`${h}-clip-upload`,onClick:()=>{m.value.click()}},[u(M,{name:"upload"},null)])]),u("div",{class:`${h}-clip-preview`},[u("div",{class:`${h}-clip-preview-target`,ref:s},null)])]),u("div",{class:`${h}-form-item`},[u("button",{class:`${h}-btn`,type:"button",onClick:()=>{if(f){const v=f.getCroppedCanvas();$.emit(i,Ft,[Ao(v.toDataURL("image/png"))],e.onOk),w()}}},[((p=o.value.clipModalTips)==null?void 0:p.buttonUpload)||((y=o.value.linkModalTips)==null?void 0:y.buttonOK)])]),u("input",{ref:m,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),Mi={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},Ri=K({props:Mi,setup(e){return()=>u(It,null,[u(Li,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),u(Hi,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),Oi=K({name:"MDEditorToolbar",props:_i,setup(e){const t=O("editorId"),l=O("usedLanguageText"),n=O("theme"),o=O("language"),{fullscreenHandler:i}=Si(e),a=`${t}-toolbar-wrapper`,m=G(),d=ae({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),s=(v,g)=>{$.emit(t,V,v,g)},r=ae({type:"link",linkVisible:!1,clipVisible:!1}),f=G();q(()=>{$.on(t,{name:Vt,callback(v){r.type=v,r.linkVisible=!0}})});const w=he(()=>{const v=e.toolbars.filter(_=>!e.toolbarsExclude.includes(_)),g=v.indexOf("="),b=g===-1?v:v.slice(0,g+1),T=g===-1?[]:v.slice(g,Number.MAX_SAFE_INTEGER);return[b,T]}),C=G(),p=()=>{$.emit(t,Ft,Array.from(C.value.files||[])),C.value.value=""};q(()=>{C.value.addEventListener("change",p)});const y=v=>{var g,b,T,_,S,L,F,N,B,P,ve,me,se,_e,Ke,Ze,xe,He,Me,ie,ee,Ht,el,tl,ll,nl,ol,il,al,sl,rl,cl,ul,dl,hl,ml,fl,gl,vl,pl,bl,yl,kl,Cl,wl,$l,Tl,_l,Sl,El,xl,Al,Il,Ll,Fl,Hl,Ml,Rl,Ol,Pl,Dl,Nl,Bl,jl,zl,Vl,Wl;if(Tn.includes(v))switch(v){case"-":return u(Ti,null,null);case"bold":return u("div",{class:`${h}-toolbar-item`,title:(g=l.value.toolbarTips)==null?void 0:g.bold,onClick:()=>{s("bold")}},[u(M,{name:"bold"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(b=l.value.toolbarTips)==null?void 0:b.bold])]);case"underline":return u("div",{class:`${h}-toolbar-item`,title:(T=l.value.toolbarTips)==null?void 0:T.underline,onClick:()=>{s("underline")}},[u(M,{name:"underline"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(_=l.value.toolbarTips)==null?void 0:_.underline])]);case"italic":return u("div",{class:`${h}-toolbar-item`,title:(S=l.value.toolbarTips)==null?void 0:S.italic,onClick:()=>{s("italic")}},[u(M,{name:"italic"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(L=l.value.toolbarTips)==null?void 0:L.italic])]);case"strikeThrough":return u("div",{class:`${h}-toolbar-item`,title:(F=l.value.toolbarTips)==null?void 0:F.strikeThrough,onClick:()=>{s("strikeThrough")}},[u(M,{name:"strike-through"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(N=l.value.toolbarTips)==null?void 0:N.strikeThrough])]);case"title":return u(Qe,{relative:`#${a}`,visible:d.title,onChange:R=>{d.title=R},overlay:u("ul",{class:`${h}-menu`,onClick:()=>{d.title=!1}},[u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h1")}},[(B=l.value.titleItem)==null?void 0:B.h1]),u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h2")}},[(P=l.value.titleItem)==null?void 0:P.h2]),u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h3")}},[(ve=l.value.titleItem)==null?void 0:ve.h3]),u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h4")}},[(me=l.value.titleItem)==null?void 0:me.h4]),u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h5")}},[(se=l.value.titleItem)==null?void 0:se.h5]),u("li",{class:`${h}-menu-item ${h}-menu-item-title`,onClick:()=>{s("h6")}},[(_e=l.value.titleItem)==null?void 0:_e.h6])])},{default:()=>{var R,te;return[u("div",{class:`${h}-toolbar-item`,title:(R=l.value.toolbarTips)==null?void 0:R.title},[u(M,{name:"title"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.title])])]}});case"sub":return u("div",{class:`${h}-toolbar-item`,title:(Ke=l.value.toolbarTips)==null?void 0:Ke.sub,onClick:()=>{s("sub")}},[u(M,{name:"sub"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Ze=l.value.toolbarTips)==null?void 0:Ze.sub])]);case"sup":return u("div",{class:`${h}-toolbar-item`,title:(xe=l.value.toolbarTips)==null?void 0:xe.sup,onClick:()=>{s("sup")}},[u(M,{name:"sup"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(He=l.value.toolbarTips)==null?void 0:He.sup])]);case"quote":return u("div",{class:`${h}-toolbar-item`,title:(Me=l.value.toolbarTips)==null?void 0:Me.quote,onClick:()=>{s("quote")}},[u(M,{name:"quote"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(ie=l.value.toolbarTips)==null?void 0:ie.quote])]);case"unorderedList":return u("div",{class:`${h}-toolbar-item`,title:(ee=l.value.toolbarTips)==null?void 0:ee.unorderedList,onClick:()=>{s("unorderedList")}},[u(M,{name:"unordered-list"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Ht=l.value.toolbarTips)==null?void 0:Ht.unorderedList])]);case"orderedList":return u("div",{class:`${h}-toolbar-item`,title:(el=l.value.toolbarTips)==null?void 0:el.orderedList,onClick:()=>{s("orderedList")}},[u(M,{name:"ordered-list"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(tl=l.value.toolbarTips)==null?void 0:tl.orderedList])]);case"task":return u("div",{class:`${h}-toolbar-item`,title:(ll=l.value.toolbarTips)==null?void 0:ll.task,onClick:()=>{s("task")}},[u(M,{name:"task"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(nl=l.value.toolbarTips)==null?void 0:nl.task])]);case"codeRow":return u("div",{class:`${h}-toolbar-item`,title:(ol=l.value.toolbarTips)==null?void 0:ol.codeRow,onClick:()=>{s("codeRow")}},[u(M,{name:"code-row"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(il=l.value.toolbarTips)==null?void 0:il.codeRow])]);case"code":return u("div",{class:`${h}-toolbar-item`,title:(al=l.value.toolbarTips)==null?void 0:al.code,onClick:()=>{s("code")}},[u(M,{name:"code"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(sl=l.value.toolbarTips)==null?void 0:sl.code])]);case"link":return u("div",{class:`${h}-toolbar-item`,title:(rl=l.value.toolbarTips)==null?void 0:rl.link,onClick:()=>{r.type="link",r.linkVisible=!0}},[u(M,{name:"link"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(cl=l.value.toolbarTips)==null?void 0:cl.link])]);case"image":return e.noUploadImg?u("div",{class:`${h}-toolbar-item`,title:(ul=l.value.toolbarTips)==null?void 0:ul.image,onClick:()=>{r.type="image",r.linkVisible=!0}},[u(M,{name:"image"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(dl=l.value.toolbarTips)==null?void 0:dl.image])]):u(Qe,{relative:`#${a}`,visible:d.image,onChange:R=>{d.image=R},overlay:u("ul",{class:`${h}-menu`,onClick:()=>{d.title=!1}},[u("li",{class:`${h}-menu-item ${h}-menu-item-image`,onClick:()=>{r.type="image",r.linkVisible=!0}},[(hl=l.value.imgTitleItem)==null?void 0:hl.link]),u("li",{class:`${h}-menu-item ${h}-menu-item-image`,onClick:()=>{C.value.click()}},[(ml=l.value.imgTitleItem)==null?void 0:ml.upload]),u("li",{class:`${h}-menu-item ${h}-menu-item-image`,onClick:()=>{r.clipVisible=!0}},[(fl=l.value.imgTitleItem)==null?void 0:fl.clip2upload])])},{default:()=>{var R,te;return[u("div",{class:`${h}-toolbar-item`,title:(R=l.value.toolbarTips)==null?void 0:R.image},[u(M,{name:"image"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.image])])]}});case"table":return u(Qe,{relative:`#${a}`,visible:d.table,onChange:R=>{d.table=R},key:"bar-table",overlay:u(Ai,{tableShape:e.tableShape,onSelected:R=>{s("table",{selectedShape:R})}},null)},{default:()=>{var R,te;return[u("div",{class:`${h}-toolbar-item`,title:(R=l.value.toolbarTips)==null?void 0:R.table},[u(M,{name:"table"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.table])])]}});case"revoke":return u("div",{class:`${h}-toolbar-item`,title:(gl=l.value.toolbarTips)==null?void 0:gl.revoke,onClick:()=>{$.emit(t,En)}},[u(M,{name:"revoke"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(vl=l.value.toolbarTips)==null?void 0:vl.revoke])]);case"next":return u("div",{class:`${h}-toolbar-item`,title:(pl=l.value.toolbarTips)==null?void 0:pl.next,onClick:()=>{$.emit(t,xn)}},[u(M,{name:"next"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(bl=l.value.toolbarTips)==null?void 0:bl.next])]);case"save":return u("div",{class:`${h}-toolbar-item`,title:(yl=l.value.toolbarTips)==null?void 0:yl.save,onClick:()=>{$.emit(t,Lt)}},[u(M,{name:"baocun"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(kl=l.value.toolbarTips)==null?void 0:kl.save])]);case"prettier":return e.noPrettier?"":u("div",{class:`${h}-toolbar-item`,title:(Cl=l.value.toolbarTips)==null?void 0:Cl.prettier,onClick:()=>{s("prettier")}},[u(M,{name:"prettier"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(wl=l.value.toolbarTips)==null?void 0:wl.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&u("div",{class:`${h}-toolbar-item`,title:($l=l.value.toolbarTips)==null?void 0:$l.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[u(M,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Tl=l.value.toolbarTips)==null?void 0:Tl.pageFullscreen])]);case"fullscreen":return u("div",{class:`${h}-toolbar-item`,title:(_l=l.value.toolbarTips)==null?void 0:_l.fullscreen,onClick:()=>{i()}},[u(M,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Sl=l.value.toolbarTips)==null?void 0:Sl.fullscreen])]);case"preview":return u("div",{class:`${h}-toolbar-item`,title:(El=l.value.toolbarTips)==null?void 0:El.preview,onClick:()=>{e.updateSetting("preview")}},[u(M,{name:"preview"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(xl=l.value.toolbarTips)==null?void 0:xl.preview])]);case"htmlPreview":return u("div",{class:`${h}-toolbar-item`,title:(Al=l.value.toolbarTips)==null?void 0:Al.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[u(M,{name:"coding"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Il=l.value.toolbarTips)==null?void 0:Il.htmlPreview])]);case"catalog":return u("div",{class:`${h}-toolbar-item`,title:(Ll=l.value.toolbarTips)==null?void 0:Ll.catalog,onClick:()=>{$.emit(t,Yt)},key:"bar-catalog"},[u(M,{name:"catalog"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Fl=l.value.toolbarTips)==null?void 0:Fl.catalog])]);case"github":return u("div",{class:`${h}-toolbar-item`,title:(Hl=l.value.toolbarTips)==null?void 0:Hl.github,onClick:()=>Un("https://github.com/imzbf/md-editor-v3")},[u(M,{name:"github"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(Ml=l.value.toolbarTips)==null?void 0:Ml.github])]);case"mermaid":return u(Qe,{relative:`#${a}`,visible:d.mermaid,onChange:R=>{d.mermaid=R},overlay:u("ul",{class:`${h}-menu`,onClick:()=>{d.mermaid=!1}},[u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("flow")}},[(Rl=l.value.mermaid)==null?void 0:Rl.flow]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("sequence")}},[(Ol=l.value.mermaid)==null?void 0:Ol.sequence]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("gantt")}},[(Pl=l.value.mermaid)==null?void 0:Pl.gantt]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("class")}},[(Dl=l.value.mermaid)==null?void 0:Dl.class]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("state")}},[(Nl=l.value.mermaid)==null?void 0:Nl.state]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("pie")}},[(Bl=l.value.mermaid)==null?void 0:Bl.pie]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("relationship")}},[(jl=l.value.mermaid)==null?void 0:jl.relationship]),u("li",{class:`${h}-menu-item ${h}-menu-item-mermaid`,onClick:()=>{s("journey")}},[(zl=l.value.mermaid)==null?void 0:zl.journey])]),key:"bar-mermaid"},{default:()=>{var R,te;return[u("div",{class:`${h}-toolbar-item`,title:(R=l.value.toolbarTips)==null?void 0:R.mermaid},[u(M,{name:"mermaid"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.mermaid])])]}});case"katex":return u(Qe,{relative:`#${a}`,visible:d.katex,onChange:R=>{d.katex=R},overlay:u("ul",{class:`${h}-menu`,onClick:()=>{d.katex=!1}},[u("li",{class:`${h}-menu-item ${h}-menu-item-katex`,onClick:()=>{s("katexInline")}},[(Vl=l.value.katex)==null?void 0:Vl.inline]),u("li",{class:`${h}-menu-item ${h}-menu-item-katex`,onClick:()=>{s("katexBlock")}},[(Wl=l.value.katex)==null?void 0:Wl.block])]),key:"bar-katex"},{default:()=>{var R,te;return[u("div",{class:`${h}-toolbar-item`,title:(R=l.value.toolbarTips)==null?void 0:R.katex},[u(M,{name:"formula"},null),e.showToolbarName&&u("div",{class:`${h}-toolbar-item-name`},[(te=l.value.toolbarTips)==null?void 0:te.katex])])]}})}else if(e.defToolbars instanceof Array){const R=e.defToolbars[v];return R?zt(R,{theme:n.value,language:o.value,insert(Mt){$.emit(t,V,"universal",{generate:Mt})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const R=e.defToolbars.children[v];return R?zt(R,{theme:n.value,language:o.value,insert(Mt){$.emit(t,V,"universal",{generate:Mt})}}):""}else return""};return H(()=>e.toolbars,()=>{Fe(()=>{m.value&&Wn(m.value)})},{immediate:!0}),()=>{const v=w.value[0].map(b=>y(b)),g=w.value[1].map(b=>y(b));return u(It,null,[e.toolbars.length>0&&u("div",{class:`${h}-toolbar-wrapper`,ref:m,id:a},[u("div",{class:[`${h}-toolbar`,e.showToolbarName&&`${h}-stn`]},[u("div",{class:`${h}-toolbar-left`,ref:f},[v]),u("div",{class:`${h}-toolbar-right`},[g])])]),u("input",{ref:C,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),u(Ri,{linkVisible:r.linkVisible,clipVisible:r.clipVisible,type:r.type,onCancel:()=>{r.linkVisible=!1,r.clipVisible=!1},onOk:b=>{b&&s(r.type,{desc:b.desc,url:b.url}),r.linkVisible=!1,r.clipVisible=!1}},null)])}}}),Pi=`.${h}-preview > [data-line]`,Di=(e,t)=>{const l=At(()=>{e.removeEventListener("scroll",n),e.addEventListener("scroll",n),t.removeEventListener("scroll",n),t.addEventListener("scroll",n)},50),n=o=>{const i=e.clientHeight,a=t.clientHeight,m=e.scrollHeight,d=t.scrollHeight,s=(m-i)/(d-a);o.target===e?(t.removeEventListener("scroll",n),t.scrollTo({top:e.scrollTop/s}),l()):(e.removeEventListener("scroll",n),e.scrollTo({top:t.scrollTop*s}),l())};return[()=>{l().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",n),t.removeEventListener("scroll",n)}]},Ni=(e,t,l)=>{const{view:n}=l,o=qn(),i=v=>n.lineBlockAt(n.state.doc.line(v).from).top,a=v=>n.lineBlockAt(n.state.doc.line(v).from).height;let m=[],d=[],s=[];const r=()=>{m=[],d=[],s=[],d=d.concat(Array.from(t.querySelectorAll(Pi)));const v=d.map(_=>Number(_.dataset.line)+1);s=s.concat(v);const{lines:g}=n.state.doc;let b=1,T=v.shift()??g;for(let _=1;_<=g;_++)_===T&&(b=_,T=v.shift()||g+1),m.push({start:b,end:T-1})};let f=0,w=0;const C=()=>{var v,g;if(w!==0)return!1;f++;const{scrollDOM:b,contentHeight:T}=n;let _=+getComputedStyle(t).paddingTop.replace("px","");const S=n.lineBlockAtHeight(b.scrollTop),{number:L}=n.state.doc.lineAt(S.from),F=m[L-1];if(!F)return!1;let N=i(F.end)+a(F.end),B=0;const P=i(F.start),ve=t.querySelector(`[data-line="${F.start-1}"]`)||((v=t.firstElementChild)==null?void 0:v.firstElementChild),me=t.querySelector(`[data-line="${F.end}"]`)||((g=t.lastElementChild)==null?void 0:g.lastElementChild);let se=0,_e=0;P===0?(B=b.scrollTop/N,ve===me?(_=0,N=T-b.offsetHeight,se=me.offsetTop+me.offsetHeight-t.clientHeight):se=me.offsetTop):(B=(b.scrollTop-P)/(N-P),_e=ve.offsetTop,se=me.offsetTop-_e),N>b.scrollHeight-b.clientHeight&&(B=(b.scrollTop-P)/(b.scrollHeight-b.clientHeight-P),_e=ve.offsetTop,se=t.scrollHeight-t.clientHeight-_e+10);const Ke=_e-_+se*B;o(t,Ke,()=>{f--})},p=()=>{var v,g,b,T,_,S;if(f!==0)return;w++;const{scrollDOM:L}=n,F=t.scrollTop,N=t.scrollHeight;let B=(v=t.firstElementChild)==null?void 0:v.firstElementChild,P=(g=t.firstElementChild)==null?void 0:g.lastElementChild;if(s.length>0){let Me=Math.ceil(Number(s[s.length-1])*(F/N)),ie=s.findLastIndex(ee=>ee<=Me);ie=ie===-1?0:ie,Me=s[ie];for(let ee=ie;ee>=0&&ee<s.length;)if(d[ee].offsetTop>F){if(ee-1>=0){ee--;continue}Me=-1,ie=ee;break}else{if(ee+1<=s.length&&d[ee+1].offsetTop<F){ee++;continue}Me=s[ee],ie=ee;break}switch(Me){case-1:{B=(b=t.firstElementChild)==null?void 0:b.firstElementChild,P=d[ie];break}case s.length-1:{B=d[ie],P=(T=t.firstElementChild)==null?void 0:T.lastElementChild;break}default:B=d[ie],P=d[ie+1]}}const ve=B===((_=t.firstElementChild)==null?void 0:_.firstElementChild)?0:B.offsetTop;let me=P.offsetTop,se=0;const{start:_e,end:Ke}=m[Number(B.dataset.line||0)],Ze=i(_e);let xe=i(Ke+1),He=0;xe>L.scrollHeight-L.clientHeight||P.scrollTop>t.scrollHeight-t.clientHeight?(se=Math.max((F-ve)/(t.scrollHeight-ve-t.clientHeight),0),xe=i(n.state.doc.lines)+a(n.state.doc.lines),He=8+xe-Ze-e.clientHeight):B===((S=t.firstElementChild)==null?void 0:S.firstElementChild)?(B===P&&(me=P.offsetTop+P.offsetHeight+ +getComputedStyle(P).marginBottom.replace("px","")),He=xe,se=Math.max(F/me,0)):(se=Math.max((F-ve)/(me-ve),0),He=xe-Ze),o(e,Ze+He*se,()=>{w--})},y=Gn(v=>{var g;const{scrollDOM:b,contentHeight:T}=n,_=b.clientHeight;if(T<=_||t.firstElementChild.clientHeight<=t.clientHeight||n.state.doc.lines<((g=m[m.length-1])==null?void 0:g.end))return!1;v.target===e?C():p()},8);return[()=>{r(),e.addEventListener("scroll",y),t.addEventListener("scroll",y),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",y),t.removeEventListener("scroll",y)}]},Bi=(e,t,l)=>{const n=O("editorId");let o=()=>{},i=()=>{};const a=()=>{o();const m=document.querySelector(`#${n} .cm-scroller`),d=document.querySelector(`[id="${n}-preview-wrapper"]`),s=document.querySelector(`[id="${n}-html-wrapper"]`);(d||s)&&([i,o]=(d?Ni:Di)(m,d||s,l.value)),e.scrollAuto&&i()};H([t,je(e.setting,"preview"),je(e.setting,"htmlPreview"),je(e.setting,"fullscreen"),je(e.setting,"pageFullscreen")],()=>{Fe(a)}),H(()=>e.scrollAuto,m=>{m?i():o()}),q(a)},ji=(e,t,l)=>{var n,o,i,a,m,d;let s="",r=0,f=0,w=!0,C=!1;const p=t.getSelectedText(),y=(n=Z.editorConfig)==null?void 0:n.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const v=e.replace(/^h(\d)/,(g,b)=>new Array(Number(b)).fill("#",0,b).join(""));s=`${v} ${p}`,r=v.length+1}else if(e==="prettier"){const v=window.prettier||((i=(o=Z.editorExtensions)==null?void 0:o.prettier)==null?void 0:i.prettierInstance),g=[((a=window.prettierPlugins)==null?void 0:a.markdown)||((d=(m=Z.editorExtensions)==null?void 0:m.prettier)==null?void 0:d.parserMarkdownInstance)];!v||g[0]===void 0?($.emit(l.editorId,qe,{name:"prettier",message:"prettier is undefined"}),s=t.getValue()):s=v.format(t.getValue(),{parser:"markdown",plugins:g}),w=!1,C=!0}else switch(e){case"bold":{s=`**${p}**`,r=2,f=-2;break}case"underline":{s=`<u>${p}</u>`,r=3,f=-4;break}case"italic":{s=`*${p}*`,r=1,f=-1;break}case"strikeThrough":{s=`~~${p}~~`,r=2,f=-2;break}case"sub":{s=`<sub>${p}</sub>`,r=5,f=-6;break}case"sup":{s=`<sup>${p}</sup>`,r=5,f=-6;break}case"codeRow":{s="`"+p+"`",r=1,f=-1;break}case"quote":{s=`> ${p}`,r=2;break}case"orderedList":{s=`1. ${p}`,r=3;break}case"unorderedList":{s=`- ${p}`,r=2;break}case"task":{s=`- [ ] ${p}`,r=6;break}case"code":{const v=l.text||p||"",g=l.mode||"language";s=`\`\`\`${g}
${v}
\`\`\`
`,r=3,f=3+g.length-s.length;break}case"table":{s="|";const{selectedShape:v={x:1,y:1}}=l,{x:g,y:b}=v;for(let T=0;T<=b;T++)s+=" col |";s+=`
|`;for(let T=0;T<=b;T++)s+=" - |";for(let T=0;T<=g;T++){s+=`
|`;for(let _=0;_<=b;_++)s+=" content |"}r=2,f=5-s.length;break}case"link":{const{desc:v,url:g}=l;s=`[${v}](${g})`,w=!1;break}case"image":{const{desc:v,url:g,urls:b}=l;b instanceof Array?s=b.reduce((T,_)=>{const{url:S="",alt:L="",title:F=""}=typeof _=="object"?_:{url:_};return T+`![${L}](${S}${F?" '"+F+"'":""})
`},""):s=`![${v}](${g})
`,w=!1;break}case"flow":{s=`\`\`\`mermaid
${(y==null?void 0:y.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,r=3,f=10-s.length;break}case"sequence":{s=`\`\`\`mermaid
${(y==null?void 0:y.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,r=3,f=10-s.length;break}case"gantt":{s=`\`\`\`mermaid
${(y==null?void 0:y.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,r=3,f=10-s.length;break}case"class":{s=`\`\`\`mermaid
${(y==null?void 0:y.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,r=3,f=10-s.length;break}case"state":{s=`\`\`\`mermaid
${(y==null?void 0:y.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,r=3,f=10-s.length;break}case"pie":{s=`\`\`\`mermaid
${(y==null?void 0:y.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,r=3,f=10-s.length;break}case"relationship":{s=`\`\`\`mermaid
${(y==null?void 0:y.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,r=3,f=10-s.length;break}case"journey":{s=`\`\`\`mermaid
${(y==null?void 0:y.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,r=3,f=10-s.length;break}case"katexInline":{s="$$",r=1,f=-1;break}case"katexBlock":{s=`$$

$$
`,r=3,f=-4;break}case"universal":{const{generate:v}=l,g=v(p);s=g.targetValue,w=g.select??!0,r=g.deviationStart||0,f=g.deviationEnd||0}}return{text:s,options:{select:w,deviationStart:r,deviationEnd:f,replaceAll:C}}},zi="#e5c07b",sn="var(--md-color)",Vi="#56b6c2",Wi="#ffffff",st="var(--md-color)",rn="#e5c07b",Ui="#e5c07b",Gi="var(--md-color)",cn="#d19a66",qi="#c678dd",Ki="#21252b",Zi="#2c313a",un="var(--md-bk-color)",Dt="var(--md-bk-color)",Xi="#ceedfa33",dn="#528bff",Yi=Ne.theme({"&":{color:st,backgroundColor:un},".cm-content":{caretColor:dn},".cm-cursor, .cm-dropCursor":{borderLeftColor:dn},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Xi},".cm-panels":{backgroundColor:Ki,color:st},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:un,color:st,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Zi},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Dt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Dt,borderBottomColor:Dt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:st}}},{dark:!0}),Ji=wn.define([{tag:k.keyword,color:qi},{tag:[k.name,k.deleted,k.character,k.propertyName,k.macroName],color:sn},{tag:[k.function(k.variableName),k.labelName],color:Ui},{tag:[k.color,k.constant(k.name),k.standard(k.name)],color:cn},{tag:[k.definition(k.name),k.separator],color:st},{tag:[k.typeName,k.className,k.number,k.changed,k.annotation,k.modifier,k.self,k.namespace],color:zi},{tag:[k.operator,k.operatorKeyword,k.url,k.escape,k.regexp,k.link,k.special(k.string)],color:Vi},{tag:[k.meta,k.comment],color:rn},{tag:k.strong,fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.strikethrough,textDecoration:"line-through"},{tag:k.link,color:rn,textDecoration:"underline"},{tag:k.heading,fontWeight:"bold",color:sn},{tag:[k.atom,k.bool,k.special(k.variableName)],color:cn},{tag:[k.processingInstruction,k.string,k.inserted],color:Gi},{tag:k.invalid,color:Wi}]),hn=[Yi,$n(Ji)],Qi="#e5c07b",mn="#3f4a54",ea="#56b6c2",ta="#fff",rt="#3f4a54",fn="#2d8cf0",la="#2d8cf0",na="#3f4a54",gn="#d19a66",oa="#c678dd",ia="#21252b",aa="#ceedfa33",vn="var(--md-bk-color)",Nt="var(--md-bk-color)",sa="#bad5fa",pn="#3f4a54",ra=Ne.theme({"&":{color:rt,backgroundColor:vn},".cm-content":{caretColor:pn},".cm-cursor, .cm-dropCursor":{borderLeftColor:pn},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:sa},".cm-panels":{backgroundColor:ia,color:rt},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:vn,color:rt,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:aa},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Nt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Nt,borderBottomColor:Nt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:rt}}}),ca=wn.define([{tag:k.keyword,color:oa},{tag:[k.name,k.deleted,k.character,k.propertyName,k.macroName],color:mn},{tag:[k.function(k.variableName),k.labelName],color:la},{tag:[k.color,k.constant(k.name),k.standard(k.name)],color:gn},{tag:[k.definition(k.name),k.separator],color:rt},{tag:[k.typeName,k.className,k.number,k.changed,k.annotation,k.modifier,k.self,k.namespace],color:Qi},{tag:[k.operator,k.operatorKeyword,k.url,k.escape,k.regexp,k.link,k.special(k.string)],color:ea},{tag:[k.meta,k.comment],color:fn},{tag:k.strong,fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.strikethrough,textDecoration:"line-through"},{tag:k.link,color:fn,textDecoration:"underline"},{tag:k.heading,fontWeight:"bold",color:mn},{tag:[k.atom,k.bool,k.special(k.variableName)],color:gn},{tag:[k.processingInstruction,k.string,k.inserted],color:na},{tag:k.invalid,color:ta}]),bn=[ra,$n(ca)],bt=(e,t,l,n,o)=>(i,a,m,d)=>{const s=`${e}${t}`.slice(d-m);i.dispatch(i.state.replaceSelection(`${s}${l}${n}`));const r=m+a.label.length+(o==="title"?l.length:0);i.dispatch({selection:Ie.create([Ie.range(m+a.label.length+(o==="title"?1:-t.length),r),Ie.cursor(r)],1)}),i.focus()},yn=e=>(t,l,n,o)=>{const i=e.slice(o-n);t.dispatch(t.state.replaceSelection(`${i} `))},kn=e=>{const t=l=>{const n=l.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|^\$\$?|!+\s*\w*/);return n===null||n.from==n.to&&l.explicit?null:{from:n.from,options:[...["h1","h2","h3","h4","h5","h6"].map((o,i)=>{const a=new Array(i+1).fill("#").join("");return{label:a,type:"text",apply:yn(a)}}),...["unchecked","checked"].map(o=>{const i=o==="checked"?"- [x]":"- [ ]";return{label:i,type:"text",apply:yn(i)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(o=>({label:`${o[0]}${o[1]}`,type:"text",apply:bt(o[0],o[1],"",o[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:bt("$","","","$","type")},{label:"$$",type:"text",apply:bt("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(o=>({label:`!!! ${o}`,type:"text",apply:bt("!!!",` ${o}`," Title",`

!!!`,"title")}))]}};return io({override:e?[t,...e]:[t]})},Ye=e=>{const t=new Je;return n=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(n)}):e.dispatch({effects:co.appendConfig.of(t.of(n))}),!0)};class ua{constructor(t){Re(this,"view"),Re(this,"maxLength",Number.MAX_SAFE_INTEGER),Re(this,"toggleTabSize"),Re(this,"togglePlaceholder"),Re(this,"setExtensions"),Re(this,"toggleDisabled"),Re(this,"toggleReadOnly"),Re(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=Ye(this.view),this.togglePlaceholder=Ye(this.view),this.setExtensions=Ye(this.view),this.toggleDisabled=Ye(this.view),this.toggleReadOnly=Ye(this.view),this.toggleMaxlength=Ye(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,l=0,n=this.view.state.doc.length){this.view.dispatch({changes:{from:l,to:n,insert:t}})}getSelectedText(){const{from:t,to:l}=this.view.state.selection.main;return this.view.state.sliceDoc(t,l)}replaceSelectedText(t,l={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},n){try{if(l.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:o}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(t)),l.select){const i=o+t.length+l.deviationEnd;this.view.dispatch({selection:Ie.create([Ie.range(o+l.deviationStart,i),Ie.cursor(i)],1)})}this.view.focus()}catch(o){if(o.message==="The input text is too long")$.emit(n,qe,{name:"overlength",message:o.message,data:t});else throw o}}setTabSize(t){this.toggleTabSize([Ot.tabSize.of(t),ao.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder(so(t))}focus(t){if(this.view.focus(),!t)return;let l=0,n=0,o=0;switch(t){case"start":break;case"end":{l=n=o=this.getValue().length;break}default:l=t.rangeAnchor||t.cursorPos,n=t.rangeHead||t.cursorPos,o=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:Ie.create([Ie.range(l,n),Ie.cursor(o)],1)})}setDisabled(t){this.toggleDisabled([Ne.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([Ot.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([Ot.changeFilter.of(l=>l.newDoc.length<=t)])}}const da=e=>{const t=O("editorId");return n=>{if(!n.clipboardData)return;if(n.clipboardData.files.length>0){const{files:i}=n.clipboardData;$.emit(t,Ft,Array.from(i).filter(a=>/image\/.*/.test(a.type))),n.preventDefault();return}if(e.autoDetectCode&&n.clipboardData.types.includes("vscode-editor-data")){const i=JSON.parse(n.clipboardData.getData("vscode-editor-data"));$.emit(t,V,"code",{mode:i.mode,text:n.clipboardData.getData("text/plain")}),n.preventDefault();return}const o=n.clipboardData.getData("text/plain");e.maxlength&&o.length+e.modelValue.length>e.maxlength&&$.emit(t,qe,{name:"overlength",message:"The input text is too long",data:o})}},ha=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>($.emit(e,V,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:uo,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:_=>($.emit(e,Lt,_.state.doc.toString()),!0),shift:()=>($.emit(e,V,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>($.emit(e,V,"underline"),!0),shift:()=>($.emit(e,V,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>($.emit(e,V,"italic"),!0),shift:()=>($.emit(e,Vt,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>($.emit(e,V,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>($.emit(e,V,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>($.emit(e,V,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>($.emit(e,V,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>($.emit(e,V,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>($.emit(e,V,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>($.emit(e,V,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>($.emit(e,V,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>($.emit(e,V,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>($.emit(e,V,"code"),!0),any(_,S){return(S.ctrlKey||S.metaKey)&&S.altKey&&S.code==="KeyC"?($.emit(e,V,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>($.emit(e,Vt,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:($.emit(e,V,"prettier"),!0)},{any:(_,S)=>(S.ctrlKey||S.metaKey)&&S.altKey&&S.shiftKey&&S.code==="KeyT"?($.emit(e,V,"table"),!0):!1}],ma=e=>{const t=O("tabWidth"),l=O("editorId"),n=O("theme"),o=G(),i=Ge(),a=new Je,m=new Je,d=new Je,s=new Je,r=new Je,f=ha(l,e),w=G(!1),p={paste:da(e),blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,compositionstart:()=>{console.log("compositionstart"),w.value=!0},compositionend:(g,b)=>{console.log("compositionend"),w.value=!1,e.updateModelValue(b.state.doc.toString())},input:g=>{e.onInput&&e.onInput(g);const{data:b}=g;e.maxlength&&e.modelValue.length+b.length>e.maxlength&&$.emit(l,qe,{name:"overlength",message:"The input text is too long",data:b})}},y=[Jn.of([...Qn,...eo,...f,to]),s.of(Ul()),a.of(lo({codeLanguages:ro})),Ne.lineWrapping,Ne.updateListener.of(g=>{g.docChanged&&(e.onChange(g.state.doc.toString()),w.value||e.updateModelValue(g.state.doc.toString()))}),r.of(Ne.domEventHandlers(p))],v=()=>{const g=[...y,m.of(n.value==="light"?bn:hn),d.of(kn(e.completions))];return Z.codeMirrorExtensions(n.value,g,[...f])};return q(()=>{const g=new Ne({doc:e.modelValue,parent:o.value,extensions:[v()]}),b=new ua(g);i.value=b,setTimeout(()=>{b.setTabSize(t),b.setDisabled(e.disabled),b.setReadOnly(e.readonly),e.placeholder&&b.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&b.setMaxLength(e.maxlength),e.autofocus&&g.focus()},0),$.on(l,{name:En,callback(){no(g)}}),$.on(l,{name:xn,callback(){oo(g)}}),$.on(l,{name:V,callback(T,_={}){var S;const{text:L,options:F}=ji(T,i.value,_);(S=i.value)==null||S.replaceSelectedText(L,F,l)}}),$.on(l,{name:In,callback(T){var _;const S={...p},L=Object.keys(p);for(const F in T){const N=F;L.includes(N)?S[N]=(B,P)=>{T[N](B,P),B.defaultPrevented||p[N](B,P)}:S[N]=T[N]}(_=i.value)==null||_.view.dispatch({effects:r.reconfigure(Ne.domEventHandlers(S))})}})}),H(n,()=>{var g;(g=i.value)==null||g.view.dispatch({effects:m.reconfigure(n.value==="light"?bn:hn)})},{deep:!0}),H(()=>e.completions,()=>{var g;(g=i.value)==null||g.view.dispatch({effects:d.reconfigure(kn(e.completions))})},{deep:!0}),H(()=>e.modelValue,()=>{var g,b;((g=i.value)==null?void 0:g.getValue())!==e.modelValue&&((b=i.value)==null||b.setValue(e.modelValue))}),H(()=>e.placeholder,()=>{var g;(g=i.value)==null||g.setPlaceholder(e.placeholder)}),H(()=>e.disabled,()=>{var g;(g=i.value)==null||g.setDisabled(e.disabled)}),H(()=>e.readonly,()=>{var g;(g=i.value)==null||g.setDisabled(e.readonly)}),H(()=>e.maxlength,()=>{var g;e.maxlength&&((g=i.value)==null||g.setMaxLength(e.maxlength))}),{inputWrapperRef:o,codeMirrorUt:i,resetHistory(){var g,b;(g=i.value)==null||g.view.dispatch({effects:s.reconfigure([])}),(b=i.value)==null||b.view.dispatch({effects:s.reconfigure(Ul())})}}},fa=(e,t,l)=>{const n=ae({resizedWidth:e.inputBoxWitdh}),o=ae({width:e.inputBoxWitdh}),i=ae({left:e.inputBoxWitdh,display:"initial"}),a=s=>{var r,f,w;const C=((r=t.value)==null?void 0:r.offsetWidth)||0,p=((f=t.value)==null?void 0:f.getBoundingClientRect().x)||0;let y=s.x-p;y<pt?y=pt:y>C-pt&&(y=C-pt);const v=`${y}px`;o.width=v,i.left=v,n.resizedWidth=v,(w=e.onInputBoxWitdhChange)==null||w.call(e,v)},m=()=>{document.addEventListener("mousemove",a)},d=()=>{document.removeEventListener("mousemove",a)};return q(()=>{var s;(s=l.value)==null||s.addEventListener("mousedown",m),document.addEventListener("mouseup",d)}),gt(()=>{var s,r;(s=l.value)==null||s.removeEventListener("mousedown",m),(r=l.value)==null||r.removeEventListener("mouseup",d)}),H(()=>e.inputBoxWitdh,s=>{s&&(o.width=s,i.left=s)}),H([je(e.setting,"htmlPreview"),je(e.setting,"preview")],()=>{!e.setting.htmlPreview&&!e.setting.preview?(o.width="100%",i.display="none"):(o.width=n.resizedWidth,i.display="initial")},{immediate:!0}),{inputWrapperStyle:o,resizeOperateStyle:i}},ga=K({name:"MDEditorContent",props:oi,setup(e,t){const l=O("editorId"),n=G(""),o=G(),i=G(),{inputWrapperRef:a,codeMirrorUt:m,resetHistory:d}=ma(e),{inputWrapperStyle:s,resizeOperateStyle:r}=fa(e,o,i);return Bi(e,n,m),t.expose({getSelectedText(){var f;return(f=m.value)==null?void 0:f.getSelectedText()},focus(f){var w;(w=m.value)==null||w.focus(f)},resetHistory:d}),()=>u("div",{class:`${h}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:o},[u("div",{class:`${h}-input-wrapper`,style:s,ref:a},null),(e.setting.htmlPreview||e.setting.preview)&&u("div",{class:`${h}-resize-operate`,style:r,ref:i},null),u(On,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:f=>{n.value=f,e.onHtmlChanged(f)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid},null),e.catalogVisible&&u(ct,{theme:e.theme,class:`${h}-catalog-editor`,editorId:l,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),va=K({props:{modelValue:{type:String,default:""}},setup(e){const t=O("usedLanguageText");return()=>{var l,n;return u("div",{class:`${h}-footer-item`},[u("label",{class:`${h}-footer-label`},[`${(l=t.value.footer)==null?void 0:l.markdownTotal}:`]),u("span",null,[((n=e.modelValue)==null?void 0:n.length)||0])])}}}),pa={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},ba=K({props:pa,setup(e){return()=>u("div",{class:[`${h}-checkbox`,e.checked&&`${h}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),ya={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},ka=K({props:ya,setup(e){const t=O("usedLanguageText");return()=>{var l;return u("div",{class:`${h}-footer-item`},[u("label",{class:`${h}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(l=t.value.footer)==null?void 0:l.scrollAuto]),u(ba,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),Ca={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},wa=K({name:"MDEditorFooter",props:Ca,setup(e){const t=he(()=>{const n=e.footers.indexOf("="),o=n===-1?e.footers:e.footers.slice(0,n),i=n===-1?[]:e.footers.slice(n,Number.MAX_SAFE_INTEGER);return[o,i]}),l=n=>{if(_n.includes(n))switch(n){case"markdownTotal":return u(va,{modelValue:e.modelValue},null);case"scrollSwitch":return u(ka,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[n]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[n]||""};return()=>{const n=t.value[0].map(i=>l(i)),o=t.value[1].map(i=>l(i));return u("div",{class:`${h}-footer`},[u("div",{class:`${h}-footer-left`},[n]),u("div",{class:`${h}-footer-right`},[o])])}}}),Bt=K({name:"MdEditorV3",props:mi,emits:fi,setup(e,t){const{editorId:l,noKatex:n,noMermaid:o,noPrettier:i,noUploadImg:a,noHighlight:m}=e,d=ae({scrollAuto:e.scrollAuto}),s=G();ii(e,t),ai(e),si(e),ri(e,t);const[r,f]=ci(e,t),w=ui(e);return gt(()=>{$.clear(l)}),di(e,t,w,r,f,s),()=>{var C;const p=ge({props:e,ctx:t},"defToolbars"),y=ge({props:e,ctx:t},"defFooters");return u("div",{id:l,class:[h,e.class,e.theme==="dark"&&`${h}-dark`,r.fullscreen||r.pageFullscreen?`${h}-fullscreen`:""],style:e.style},[u(Oi,{noPrettier:i,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:r,updateSetting:f,tableShape:e.tableShape,defToolbars:p,noUploadImg:a,showToolbarName:e.showToolbarName},null),u(ga,{ref:s,modelValue:e.modelValue,setting:r,mdHeadingId:e.mdHeadingId,noMermaid:o,noPrettier:i,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:n,scrollAuto:d.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:m,updateModelValue:v=>{t.emit("update:modelValue",v)},onChange:v=>{e.onChange&&e.onChange(v),t.emit("onChange",v)},onHtmlChanged:v=>{e.onHtmlChanged&&e.onHtmlChanged(v),t.emit("onHtmlChanged",v)},onGetCatalog:v=>{e.onGetCatalog&&e.onGetCatalog(v),t.emit("onGetCatalog",v)},onBlur:v=>{e.onBlur&&e.onBlur(v),t.emit("onBlur",v)},onFocus:v=>{e.onFocus&&e.onFocus(v),t.emit("onFocus",v)},onInput:v=>{e.onInput&&e.onInput(v),t.emit("onInput",v)},completions:e.completions,catalogVisible:w.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:v=>{e.onDrop&&e.onDrop(v),t.emit("onDrop",v)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:v=>{e.onInputBoxWitdhChange&&e.onInputBoxWitdhChange(v),t.emit("onInputBoxWitdhChange",v)},sanitizeMermaid:e.sanitizeMermaid},null),((C=e.footers)==null?void 0:C.length)>0&&u(wa,{modelValue:e.modelValue,footers:e.footers,defFooters:y,scrollAuto:d.scrollAuto,onScrollAutoChange:v=>d.scrollAuto=v},null)])}}});Bt.install=e=>(e.component(Bt.name,Bt),e.use(_t).use(yt).use(St).use(ct).use(Tt),e);export{Bt as E,Tt as M};
