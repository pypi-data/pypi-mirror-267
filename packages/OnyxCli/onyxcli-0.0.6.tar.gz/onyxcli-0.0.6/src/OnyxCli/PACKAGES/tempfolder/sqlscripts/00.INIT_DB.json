{
    "osqlScript": {
        "name": "00.INIT_DB",
        "query": "IF NOT EXISTS (SELECT  * FROM sys.schemas WHERE name = N'AG_to_OC' ) EXEC('CREATE SCHEMA AG_to_OC');\r\n\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'AG_to_OC' AND TABLE_NAME = 'neworder_result')\r\nBEGIN\r\n    CREATE TABLE AG_to_OC.neworder_result(\r\n        [id] [uniqueidentifier] primary key DEFAULT (newid()),\r\n        [customer_ref] [nvarchar](255) NULL,\r\n        [site_ref] [nvarchar](255) NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload] [nvarchar](max) NULL,\r\n        [result] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n\r\n--creation to du schema drop table [staging].[EXPORT_FACTURE_ELEC]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_ELEC')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_ELEC (\t\r\n        [CODE_CLIENT] [varchar](255) ,\r\n        [ID_FACTURE] [varchar](255) ,\r\n        [DATE_FACTURE] [varchar](255) ,\r\n        [NUM_FACTURE] [varchar](255),\r\n        [MONTANT_TTC] [varchar](255),\r\n        CODE_PRM [varchar](255),\r\n        INTEGRATION [varchar](255),\r\n        DATE_ECHEANCE [varchar](255)\r\n    );\r\nEND;\r\n\r\n-- creation to du schema drop table [staging].[EXPORT_FACTURE_GAZ]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_GAZ')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_GAZ (\t\r\n        [CODE_CLIENT] [varchar](255) ,\r\n        [ID_FACTURE] [varchar](255) ,\r\n        [DATE_FACTURE] [varchar](255) ,\r\n        [NUM_FACTURE] [varchar](255),\r\n        [MONTANT_TTC] [varchar](255),\r\n        CODE_PRM [varchar](255),\r\n        INTEGRATION [varchar](255),\r\n        DATE_ECHEANCE [varchar](255)\r\n    );\r\nEND;\r\n\r\n-- creation to du schema drop table [staging].[EXPORT_FACTURE_MANUELLE_GAZ]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_MANUELLE_GAZ')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_MANUELLE_GAZ (\t\r\n        [CODE_CLIENT] [varchar](255) ,\r\n        [ID_FACTURE] [varchar](255) ,\r\n        [DATE_FACTURE] [varchar](255) ,\r\n        [NUM_FACTURE] [varchar](255),\r\n        [MONTANT_TTC] [varchar](255),\r\n        CODE_PRM [varchar](255),\r\n        INTEGRATION [varchar](255),\r\n        DATE_ECHEANCE [varchar](255)\r\n    );\r\nEND;\r\n\r\n-- creation to du schema drop table [staging].[EXPORT_FACTURE_LIGNES_ELEC]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_LIGNES_ELEC')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_LIGNES_ELEC (\r\n        [ACCOUNTINGARTICLECODE] [varchar](255) ,\r\n        [AMOUNTTAX] [varchar](255),\r\n        [AMOUNTWITHOUTTAX] [varchar](255),\r\n        [AMOUNTWITHTAX] [varchar](255),\r\n        [STARTDATE] [varchar](255) ,\r\n        [ENDDATE] [varchar](255) ,\r\n        [INVOICEID] [varchar](255),\r\n        [LABEL] [varchar](255) ,\r\n        [PRODUCTCODE] [varchar](255),\r\n        [QUANTITY] [varchar](255),\r\n        [TAXMODE] [varchar](255) ,\r\n        [UNITPRICE] [varchar](255) ,\r\n        [UNITPRICECURRENCY] [varchar](255) ,\r\n        [VALUEDATE] [varchar](255) ,\r\n        [USERACCOUNTCODE] [varchar](255),\r\n        [ID_FACTURE] [varchar](255) \r\n    );\r\nEND;\r\n\r\n-- creation to du schema drop table [staging].[EXPORT_FACTURE_LIGNES_GAZ]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_LIGNES_GAZ')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_LIGNES_GAZ (\r\n        [ACCOUNTINGARTICLECODE] [varchar](255) ,\r\n        [AMOUNTTAX] [varchar](255),\r\n        [AMOUNTWITHOUTTAX] [varchar](255),\r\n        [AMOUNTWITHTAX] [varchar](255),\r\n        [STARTDATE] [varchar](255) ,\r\n        [ENDDATE] [varchar](255) ,\r\n        [INVOICEID] [varchar](255),\r\n        [LABEL] [varchar](255) ,\r\n        [PRODUCTCODE] [varchar](255),\r\n        [QUANTITY] [varchar](255),\r\n        [TAXMODE] [varchar](255) ,\r\n        [UNITPRICE] [varchar](255) ,\r\n        [UNITPRICECURRENCY] [varchar](255) ,\r\n        [VALUEDATE] [varchar](255) ,\r\n        [USERACCOUNTCODE] [varchar](255),\r\n        [ID_FACTURE] [varchar](255) \r\n    );\r\nEND;\r\n\r\n-- creation to du schema drop table [staging].[EXPORT_FACTURE_MANUELLE_LIGNES_GAZ]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'staging' AND TABLE_NAME = 'EXPORT_FACTURE_MANUELLE_LIGNES_GAZ')\r\nBEGIN\r\n    CREATE TABLE staging.EXPORT_FACTURE_MANUELLE_LIGNES_GAZ (\r\n        [ACCOUNTINGARTICLECODE] [varchar](255) ,\r\n        [AMOUNTTAX] [varchar](255),\r\n        [AMOUNTWITHOUTTAX] [varchar](255),\r\n        [AMOUNTWITHTAX] [varchar](255),\r\n        [STARTDATE] [varchar](255) ,\r\n        [ENDDATE] [varchar](255) ,\r\n        [INVOICEID] [varchar](255),\r\n        [LABEL] [varchar](255) ,\r\n        [PRODUCTCODE] [varchar](255),\r\n        [QUANTITY] [varchar](255),\r\n        [TAXMODE] [varchar](255) ,\r\n        [UNITPRICE] [varchar](255) ,\r\n        [UNITPRICECURRENCY] [varchar](255) ,\r\n        [VALUEDATE] [varchar](255) ,\r\n        [USERACCOUNTCODE] [varchar](255),\r\n        [ID_FACTURE] [varchar](255) \r\n    );\r\nEND;\r\n\r\n--creation to du schema [AG_to_OC].[invoice_result]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'AG_to_OC' AND TABLE_NAME = 'invoice_result')\r\nBEGIN\r\n    CREATE TABLE AG_to_OC.invoice_result (\r\n        [energie] [varchar](255) NOT NULL, \r\n        [code_client] [varchar](255) NOT NULL,\r\n        [id_facture] [varchar](255) NOT NULL,\r\n        [code_prm] [varchar](255) NOT NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload_invoice] [nvarchar](max) NULL,\r\n        [payload_lines] [nvarchar](max) NULL,\r\n        [result_invoice] [nvarchar](max) NULL,\r\n        [result_lines] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'antargaz' AND TABLE_NAME = 'fichier_facturation_xlsx')\r\nBEGIN\r\n    CREATE TABLE [antargaz].[fichier_facturation_xlsx](\r\n        [sn_file_name] [varchar](500) NULL,\r\n        [sn_file_rownum] [bigint] NULL,\r\n        [Energie] [varchar](50) NULL,\r\n        [ClederegroupementFormulairesigne] [varchar](50) NULL,\r\n        [ClederegroupementFormulairenonsigne] [varchar](50) NULL,\r\n        [CodeClient] [varchar](50) NULL,\r\n        [CodePDL] [varchar](50) NULL,\r\n        [SIREN] [varchar](50) NULL,\r\n        [Numcontrat] [varchar](50) NULL,\r\n        [TypeClient] [varchar](50) NULL,\r\n        [GRD] [varchar](50) NULL,\r\n        [FLAGBOMET] [varchar](50) NULL,\r\n        [Typeformulaire] [varchar](50) NULL,\r\n        [DateFormulaire] [varchar](50) NULL,\r\n        [NomClientPayeur] [varchar](500) NULL,\r\n        [Adresse1ClientPayeur] [varchar](500) NULL,\r\n        [Adresse2ClientPayeur] [varchar](500) NULL,\r\n        [Adresse3ClientPayeur] [varchar](500) NULL,\r\n        [CodePostalPayeur] [varchar](50) NULL,\r\n        [VillePayeur] [varchar](200) NULL,\r\n        [EmailContrat] [varchar](100) NULL,\r\n        [EmailFacture] [varchar](100) NULL,\r\n        [EmailClient] [varchar](100) NULL,\r\n        [Modedenvoifacture] [varchar](100) NULL,\r\n        [Modedefactu] [varchar](100) NULL,\r\n        [Modedepaiement] [varchar](50) NULL,\r\n        [Delaidepaiement] [varchar](50) NULL,\r\n        [ID_ADMIN_PUBLIQUE] [varchar](50) NULL,\r\n        [NUMERO_MARCHE] [varchar](50) NULL,\r\n        [SERVICE_EXECUTANT] [varchar](50) NULL,\r\n        [ENGAGEMENT_JURIDIQUE] [varchar](50) NULL,\r\n        [IBAN] [varchar](50) NULL,\r\n        [BIC] [varchar](50) NULL,\r\n        [RUM] [varchar](50) NULL\r\n    );\r\nEND;\r\n\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'antargaz' AND TABLE_NAME = 'creationenmasse_ssp_xlsx')\r\nBEGIN\r\n    CREATE TABLE [antargaz].[creationenmasse_ssp_xlsx](\r\n        [sn_file_name] [varchar](500) NULL,\r\n        [sn_file_rownum] [bigint] NULL,\r\n        ClederegroupementFormulairesigne [varchar](50) NULL,\r\n        [consumer_type] [varchar](50) NULL,\r\n        [consumer_reference] [varchar](50) NULL,\r\n        [consumer_store] [varchar](50) NULL,\r\n        [consumer_gender] [varchar](50) NULL,\r\n        [consumer_last_name] [varchar](100) NULL,\r\n        [consumer_first_name] [varchar](100) NULL,\r\n        [consumer_other_last_name] [varchar](100) NULL,\r\n        [consumer_address_street_number] [varchar](50) NULL,\r\n        [consumer_address_street_type] [varchar](50) NULL,\r\n        [consumer_address_street_name] [varchar](500) NULL,\r\n        [consumer_address_complement] [varchar](500) NULL,\r\n        [consumer_zip_code] [varchar](50) NULL,\r\n        [consumer_city] [varchar](200) NULL,\r\n        [consumer_country] [varchar](50) NULL,\r\n        [consumer_email] [varchar](200) NULL,\r\n        [consumer_phone_number] [varchar](50) NULL,\r\n        [iban] [varchar](50) NULL,\r\n        [siren] [varchar](50) NULL,\r\n        [social_reference] [varchar](200) NULL\r\n    );\r\n    \r\n    CREATE CLUSTERED INDEX x_antargaz_creationenmasseSSP_pk ON [antargaz].[creationenmasse_ssp_xlsx] ([sn_file_name],[sn_file_rownum],[ClederegroupementFormulairesigne]);\r\nEND;\r\n\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'antargaz' AND TABLE_NAME = 'create_consumer_result')\r\nBEGIN\r\n    CREATE TABLE antargaz.create_consumer_result(\r\n        [id] [uniqueidentifier] primary key DEFAULT (newid()),\r\n        [ClederegroupementFormulairesigne] [nvarchar](50) NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload] [nvarchar](max) NULL,\r\n        [result] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n\r\n--creation to du schema [AG_to_OC].[add_payment_method_result]\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'AG_to_OC' AND TABLE_NAME = 'add_payment_method_result')\r\nBEGIN\r\n    CREATE TABLE AG_to_OC.add_payment_method_result (\r\n        [id] [uniqueidentifier] primary key DEFAULT (newid()),\r\n        [customer_ref] [nvarchar](255) NULL,\r\n        [site_ref] [nvarchar](255) NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload] [nvarchar](max) NULL,\r\n        [result] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n\r\n\r\n--creation to du schema\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'AG_to_OC' AND TABLE_NAME = 'invoice_regularization_result')\r\nBEGIN\r\n    CREATE TABLE AG_to_OC.invoice_regularization_result (\r\n        [id] [uniqueidentifier] primary key DEFAULT (newid()),\r\n        [energie] [varchar](255) NOT NULL,\r\n        [code_client] [varchar](255) NOT NULL,\r\n        [code_prm] [varchar](255) NOT NULL,        \r\n        [id_facture] [varchar](255) NOT NULL,\r\n        [invoice_id] [varchar](255) NOT NULL,\r\n        [diff_amount] [decimal](18, 2) NOT NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload] [nvarchar](max) NULL,\r\n        [result] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n\r\nIF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'AG_to_OC' AND TABLE_NAME = 'invoice_validate_result')\r\nBEGIN\r\n    CREATE TABLE AG_to_OC.invoice_validate_result (\r\n        [id] [uniqueidentifier] primary key DEFAULT (newid()),\r\n        [energie] [varchar](255) NOT NULL,\r\n        [code_client] [varchar](255) NOT NULL,\r\n        [code_prm] [varchar](255) NOT NULL,        \r\n        [id_facture] [varchar](255) NOT NULL,\r\n        [invoice_id] [varchar](255) NOT NULL,\r\n        [dt] [datetime] NULL default(getdate()),\r\n        [payload] [nvarchar](max) NULL,\r\n        [result] [nvarchar](max) NULL,\r\n        [issuccess] [bit] default(0)\r\n    );\r\nEND;\r\n",
        "commandTimeout": null,
        "documentation": null,
        "oProjectId": "7316024d-7485-4b92-87b3-fce9be27f367",
        "oConnectionId": "5c3be4e3-be08-4888-bfac-08db5bc711cb",
        "id": "ef17dbe1-16d6-4164-a66c-bbfef924bdfe"
    },
    "numberOfSchedules": 0,
    "oProjectName": "AG - invoice",
    "oConnectionName": "BDD-metfr-onyx"
}